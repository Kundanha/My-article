<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Bot Service Notes | Hinglish Explained</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Fira+Code:wght@400;500;600&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Prism.js for Beautiful Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <!-- Mermaid.js for Beautiful Diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-card: #16213e;
            --bg-code: #0d1117;
            --accent-green: #00ff88;
            --accent-blue: #00d4ff;
            --accent-purple: #a855f7;
            --accent-orange: #ff9f43;
            --accent-red: #ff6b6b;
            --accent-yellow: #ffd93d;
            --accent-pink: #f5576c;
            --text-primary: #e4e4e7;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --border-color: #27272a;
            --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-4: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --gradient-purple: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
            --sidebar-width: 320px;
            --font-size-base: 16px;
        }

        /* Light Theme Variables */
        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --bg-code: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background: radial-gradient(circle at 20% 80%, rgba(0, 136, 255, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(0, 212, 255, 0.08) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(0, 120, 212, 0.05) 0%, transparent 50%);
            animation: float 30s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-20px, -20px) rotate(5deg); }
        }

        /* Reading Progress Bar */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(135deg, #0078d4 0%, #00d4ff 100%);
            z-index: 1000;
            transition: width 0.1s ease;
        }

        /* ==================== SIDEBAR ==================== */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem;
            overflow-y: auto;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-header .logo {
            font-size: 2rem;
        }

        .sidebar-header h2 {
            font-size: 1.1rem;
            font-weight: 700;
            background: linear-gradient(135deg, #0078d4 0%, #00d4ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .sidebar-header span {
            font-size: 0.75rem;
            color: var(--text-muted);
            display: block;
        }

        /* Navigation Links */
        .nav-external-links {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .nav-external-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.8rem;
            background: var(--bg-card);
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .nav-external-link:hover {
            background: rgba(0, 120, 212, 0.1);
            border-color: rgba(0, 120, 212, 0.3);
            color: var(--accent-blue);
            transform: translateX(4px);
        }

        /* Search Box */
        .search-box {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);
        }

        .search-box::before {
            content: 'ğŸ”';
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.9rem;
        }

        /* Category Groups */
        .category-group {
            margin-bottom: 1.5rem;
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 0;
            cursor: pointer;
            user-select: none;
        }

        .category-title {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
        }

        .category-count {
            font-size: 0.65rem;
            background: var(--bg-card);
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
            color: var(--text-muted);
        }

        .category-items {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            margin-top: 0.5rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            border-left: 2px solid transparent;
        }

        .nav-item:hover {
            background: rgba(0, 120, 212, 0.1);
            color: var(--accent-blue);
            border-left-color: var(--accent-blue);
        }

        .nav-item.active {
            background: rgba(0, 120, 212, 0.15);
            color: var(--accent-blue);
            border-left-color: var(--accent-blue);
            font-weight: 500;
        }

        /* ==================== MAIN CONTENT ==================== */
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 2rem 3rem;
            max-width: 1000px;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 3rem 0;
            margin-bottom: 3rem;
            position: relative;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(0, 120, 212, 0.1);
            border: 1px solid rgba(0, 120, 212, 0.2);
            border-radius: 50px;
            font-size: 0.85rem;
            color: var(--accent-blue);
            margin-bottom: 1.5rem;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #0078d4 0%, #00d4ff 50%, #00ff88 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 2rem;
            line-height: 1.6;
        }

        /* Warning Banner */
        .warning-banner {
            background: linear-gradient(135deg, rgba(255, 157, 67, 0.15), rgba(255, 107, 107, 0.15));
            border: 1px solid rgba(255, 157, 67, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .warning-banner h3 {
            color: var(--accent-orange);
            font-size: 1rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .warning-banner p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .warning-banner a {
            color: var(--accent-blue);
            text-decoration: none;
        }

        .warning-banner a:hover {
            text-decoration: underline;
        }

        /* Topic Sections */
        .topic-section {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
        }

        .topic-header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .topic-badge {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            background: linear-gradient(135deg, #0078d4, #00d4ff);
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            margin-bottom: 0.75rem;
        }

        .topic-header h2 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .topic-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        /* Sections */
        .section {
            margin-bottom: 2.5rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .section-number {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient-3);
            border-radius: 10px;
            font-weight: 700;
            color: white;
            font-size: 1rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .section-content {
            padding-left: 0;
        }

        .content-text {
            color: var(--text-secondary);
            margin-bottom: 1.25rem;
            line-height: 1.8;
        }

        .highlight {
            color: var(--accent-blue);
            font-weight: 600;
        }

        /* Visual Boxes */
        .visual-box {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid var(--border-color);
        }

        .visual-box h4 {
            color: var(--accent-blue);
            font-size: 1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Mermaid Diagrams */
        .mermaid-container {
            background: var(--bg-code);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            overflow-x: auto;
        }

        .diagram-label {
            color: var(--accent-blue);
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: center;
        }

        .mermaid {
            display: flex;
            justify-content: center;
        }

        /* Hinglish Notes */
        .hinglish-note {
            background: rgba(0, 120, 212, 0.1);
            border-left: 4px solid var(--accent-blue);
            border-radius: 0 12px 12px 0;
            padding: 1.25rem 1.5rem;
            margin: 1.5rem 0;
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .hinglish-note strong {
            color: var(--text-primary);
        }

        /* Bullet Lists */
        .bullet-list {
            list-style: none;
            padding-left: 0;
            margin: 1rem 0;
        }

        .bullet-list li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-secondary);
        }

        .bullet-list li::before {
            content: 'â†’';
            position: absolute;
            left: 0;
            color: var(--accent-blue);
            font-weight: bold;
        }

        /* Code Blocks */
        pre[class*="language-"] {
            background: var(--bg-code) !important;
            border-radius: 12px;
            padding: 1.5rem !important;
            margin: 1rem 0;
            border: 1px solid var(--border-color);
            font-size: 0.9rem;
            overflow-x: auto;
        }

        code {
            font-family: 'Fira Code', 'JetBrains Mono', monospace;
        }

        :not(pre) > code {
            background: var(--bg-code);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85em;
            color: var(--accent-pink);
        }

        /* Summary Card */
        .summary-card {
            background: linear-gradient(135deg, rgba(0, 120, 212, 0.1), rgba(0, 212, 255, 0.1));
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
            border: 1px solid rgba(0, 120, 212, 0.2);
        }

        .summary-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-blue);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Feature Grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .feature-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.25rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }

        .feature-card h5 {
            color: var(--text-primary);
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feature-card p {
            color: var(--text-muted);
            font-size: 0.85rem;
            line-height: 1.5;
        }

        /* Channel Grid */
        .channel-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.75rem;
            margin: 1.5rem 0;
        }

        .channel-item {
            background: var(--bg-card);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .channel-item:hover {
            border-color: var(--accent-blue);
            background: rgba(0, 120, 212, 0.1);
        }

        .channel-item .icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .channel-item .name {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .main-content {
                margin-left: 0;
                padding: 1.5rem;
            }
        }

        @media (max-width: 640px) {
            .hero h1 {
                font-size: 1.75rem;
            }

            .topic-header h2 {
                font-size: 1.35rem;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    <div class="reading-progress" id="readingProgress"></div>

    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <span class="logo">ğŸ¤–</span>
            <div>
                <h2>ABS Notes</h2>
                <span>Azure Bot Service</span>
            </div>
        </div>

        <div class="nav-external-links">
            <a href="index.html" class="nav-external-link">
                <span>ğŸ </span>
                <span>Home</span>
            </a>
            <a href="dsa-notes.html" class="nav-external-link">
                <span>ğŸ“Š</span>
                <span>DSA Notes</span>
            </a>
            <a href="system-design.html" class="nav-external-link">
                <span>ğŸ—ï¸</span>
                <span>System Design</span>
            </a>
            <a href="reel-scripts.html" class="nav-external-link">
                <span>ğŸ¬</span>
                <span>Reel Scripts</span>
            </a>
        </div>

        <div class="search-box">
            <input type="text" placeholder="Search topics..." id="searchInput">
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸš€ Getting Started</span>
                <span class="category-count">3</span>
            </div>
            <div class="category-items">
                <a href="#intro" class="nav-item active">Introduction to ABS</a>
                <a href="#what-is-bot" class="nav-item">What is a Bot?</a>
                <a href="#bot-framework" class="nav-item">Bot Framework SDK</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ§  Core Concepts</span>
                <span class="category-count">5</span>
            </div>
            <div class="category-items">
                <a href="#activities" class="nav-item">Activities & Turns</a>
                <a href="#bot-structure" class="nav-item">Bot Structure</a>
                <a href="#adapter" class="nav-item">Bot Adapter</a>
                <a href="#turn-context" class="nav-item">Turn Context</a>
                <a href="#middleware" class="nav-item">Middleware</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ’¾ State Management</span>
                <span class="category-count">4</span>
            </div>
            <div class="category-items">
                <a href="#state-intro" class="nav-item">Why State Matters</a>
                <a href="#storage-layer" class="nav-item">Storage Layer</a>
                <a href="#state-types" class="nav-item">State Types</a>
                <a href="#state-accessors" class="nav-item">State Accessors</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸŒ Channels</span>
                <span class="category-count">2</span>
            </div>
            <div class="category-items">
                <a href="#channels-intro" class="nav-item">What are Channels?</a>
                <a href="#channels-list" class="nav-item">Available Channels</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ’¬ Dialogs & Prompts</span>
                <span class="category-count">4</span>
            </div>
            <div class="category-items">
                <a href="#dialogs" class="nav-item">Dialogs Library</a>
                <a href="#waterfall" class="nav-item">Waterfall Dialogs</a>
                <a href="#prompts" class="nav-item">Prompts</a>
                <a href="#activity-handlers" class="nav-item">Activity Handlers</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ´ Rich Messages</span>
                <span class="category-count">3</span>
            </div>
            <div class="category-items">
                <a href="#cards" class="nav-item">Cards & Attachments</a>
                <a href="#adaptive-cards" class="nav-item">Adaptive Cards</a>
                <a href="#proactive" class="nav-item">Proactive Messaging</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ§  AI & NLU</span>
                <span class="category-count">2</span>
            </div>
            <div class="category-items">
                <a href="#nlu" class="nav-item">Natural Language (CLU)</a>
                <a href="#skills" class="nav-item">Skills</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ” Authentication</span>
                <span class="category-count">1</span>
            </div>
            <div class="category-items">
                <a href="#authentication" class="nav-item">User Authentication (OAuth)</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ’¬ Teams & More</span>
                <span class="category-count">3</span>
            </div>
            <div class="category-items">
                <a href="#teams" class="nav-item">Microsoft Teams Bots</a>
                <a href="#suggested-actions" class="nav-item">Suggested Actions</a>
                <a href="#composer" class="nav-item">Bot Framework Composer</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ¨ Design Principles</span>
                <span class="category-count">2</span>
            </div>
            <div class="category-items">
                <a href="#cux" class="nav-item">Conversational UX</a>
                <a href="#bot-lifecycle" class="nav-item">Bot Lifecycle</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸš€ Testing & Deploy</span>
                <span class="category-count">2</span>
            </div>
            <div class="category-items">
                <a href="#testing" class="nav-item">Testing (Emulator)</a>
                <a href="#deployment" class="nav-item">Deployment</a>
            </div>
        </div>

        <div class="category-group">
            <div class="category-header">
                <span class="category-title">ğŸ¢ Enterprise Deep Dive</span>
                <span class="category-count">6</span>
            </div>
            <div class="category-items">
                <a href="#enterprise-deep-dive" class="nav-item">ğŸ¯ Message Journey Story</a>
                <a href="#enterprise-deep-dive" class="nav-item">Activity Schema</a>
                <a href="#enterprise-deep-dive" class="nav-item">Channel Connector</a>
                <a href="#enterprise-deep-dive" class="nav-item">WhatsApp Mapper</a>
                <a href="#enterprise-deep-dive" class="nav-item">DirectLine WebSocket</a>
                <a href="#enterprise-deep-dive" class="nav-item">OAuth & Auth Flow</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-badge">
                <span>ğŸ¤–</span>
                <span>Azure Bot Service & Bot Framework SDK</span>
            </div>
            <h1>Azure Bot Service Notes</h1>
            <p class="hero-subtitle">
                Complete Hinglish guide to understand Azure Bot Service â€” Intelligent bots banao jo users se naturally baat kar sakein! ğŸš€
            </p>
        </section>

        <!-- Important Warning -->
        <div class="warning-banner">
            <h3>âš ï¸ Important Notice â€” SDK Archival</h3>
            <p>
                <strong>Bot Framework SDK aur Bot Framework Emulator ko GitHub pe archive kar diya gaya hai.</strong> December 31, 2025 ke baad support tickets service nahi honge.<br><br>
                <strong>Naye projects ke liye recommendations:</strong><br>
                â†’ <a href="https://github.com/Microsoft/Agents" target="_blank">Microsoft 365 Agents SDK</a> â€” C#, JavaScript, Python support<br>
                â†’ <a href="https://www.microsoft.com/microsoft-copilot/microsoft-copilot-studio" target="_blank">Microsoft Copilot Studio</a> â€” SaaS-based agent platform
            </p>
        </div>

        <!-- ==================== TOPIC 1: Introduction ==================== -->
        <section class="topic-section" id="intro">
            <header class="topic-header">
                <div class="topic-badge">ğŸš€ Chapter 1 â€” Introduction</div>
                <h2>Azure Bot Service Kya Hai?</h2>
                <p class="topic-subtitle">Microsoft Bot Framework aur Azure AI Bot Service ka complete introduction!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ§ </div>
                    <h3 class="section-title">Azure Bot Service â€” Ek Nazar Mein</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Microsoft Bot Framework</span> aur <span class="highlight">Azure AI Bot Service</span> milke ek powerful combination banate hain jo tumhe <strong>intelligent bots</strong> build, test, deploy aur manage karne ki capability deta hai.
                    </p>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“š <strong>Simple Words Mein Samjho:</strong><br><br>
                        <strong>Bot</strong> = Ek automated program jo users se baat kar sakta hai (jaise WhatsApp pe customer support)<br>
                        <strong>Bot Framework</strong> = Microsoft ka toolkit jo bots banana easy banata hai<br>
                        <strong>Azure Bot Service</strong> = Cloud platform jahan ye bots host hote hain<br>
                        <strong>SDK</strong> = Software Development Kit â€” ready-made code library jo development fast kare
                    </div>

                    <p class="content-text">
                        Bot Framework mein ek <strong>modular aur extensible SDK</strong> hota hai jo bots banane aur AI services se connect karne ke liye use hota hai. Is framework se developers aise bots create kar sakte hain jo:
                    </p>

                    <ul class="bullet-list">
                        <li><strong>Speech</strong> use kar sakein â€” Voice commands samjhe</li>
                        <li><strong>Natural Language</strong> samjhe â€” Normal Hindi/English mein baat karo</li>
                        <li><strong>Questions ka Answer</strong> de sakein â€” FAQ bots</li>
                        <li><strong>Multiple Platforms</strong> pe kaam kare â€” Teams, WhatsApp, Facebook, etc.</li>
                    </ul>

                    <div class="visual-box">
                        <h4>ğŸ—ï¸ Azure Bot Service â€” Architecture Overview</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">AZURE BOT SERVICE â€” Complete Ecosystem</div>
                            <div class="mermaid">
flowchart TB
    subgraph Users["ğŸ‘¥ USERS"]
        U1["ğŸ“± Mobile App"]
        U2["ğŸ’» Website"]
        U3["ğŸ’¬ Teams"]
        U4["ğŸ“˜ Facebook"]
    end
    
    subgraph Channels["ğŸŒ CHANNELS"]
        C["Bot Connector Service<br/>Messages Relay"]
    end
    
    subgraph Bot["ğŸ¤– YOUR BOT"]
        B["Bot Application<br/>(C#/JS/Python)"]
        SDK["Bot Framework SDK"]
        B --> SDK
    end
    
    subgraph Azure["â˜ï¸ AZURE SERVICES"]
        AI["ğŸ§  Azure AI Services"]
        Storage["ğŸ’¾ Azure Storage"]
        Config["âš™ï¸ Bot Configuration"]
    end
    
    Users --> Channels
    Channels <--> Bot
    Bot --> Azure
    
    style C fill:#0078d4,color:#fff
    style B fill:#00d4ff,color:#000
    style SDK fill:#00ff88,color:#000
    style AI fill:#8338ec,color:#fff
    style Storage fill:#ff9f43,color:#fff
    style Config fill:#ff6b6b,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        ğŸ’¡ <strong>Yaad Rakho:</strong><br>
                        Azure Bot Service basically do cheezein provide karta hai:<br>
                        1. <strong>Bot Framework SDK</strong> â€” Code likhne ke liye tools<br>
                        2. <strong>Bot Connector Service</strong> â€” Different platforms se connect karne ke liye
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 2: What is a Bot ==================== -->
        <section class="topic-section" id="what-is-bot">
            <header class="topic-header">
                <div class="topic-badge">ğŸ¤– Chapter 2 â€” Fundamentals</div>
                <h2>Bot Kya Hota Hai? â€” Complete Explanation</h2>
                <p class="topic-subtitle">Bot ka matlab, kaise kaam karta hai, aur kahan-kahan use hota hai!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h3 class="section-title">Bot Ki Definition â€” Simple Words Mein</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Bot</span> ek aisa experience provide karta hai jo computer use karne jaisa nahi lagta, balki <strong>kisi insaan se baat karne jaisa</strong> lagta hai â€” ya intelligent robot se! ğŸ¤–
                    </p>

                    <p class="content-text">
                        Bots ka main purpose hota hai <strong>simple, repetitive tasks</strong> ko automate karna â€” jaise dinner reservation lena, profile information gather karna, FAQs answer karna â€” ye sab automated systems handle kar lete hain bina human intervention ke!
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ’¬ Bot Interaction â€” Kaise Hoti Hai?</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">USER â†” BOT INTERACTION FLOW</div>
                            <div class="mermaid">
flowchart LR
    subgraph Input["ğŸ“¥ USER INPUT"]
        T["ğŸ“ Text"]
        S["ğŸ¤ Speech"]
        C["ğŸƒ Cards"]
        I["ğŸ–¼ï¸ Images"]
    end
    
    subgraph Bot["ğŸ¤– BOT PROCESSING"]
        P1["1ï¸âƒ£ Input Receive"]
        P2["2ï¸âƒ£ Interpret/Understand"]
        P3["3ï¸âƒ£ Perform Task"]
        P4["4ï¸âƒ£ Generate Response"]
        P1 --> P2 --> P3 --> P4
    end
    
    subgraph Output["ğŸ“¤ BOT RESPONSE"]
        R["ğŸ’¬ Reply to User"]
    end
    
    Input --> Bot
    Bot --> Output
    
    style P1 fill:#3a86ff,color:#fff
    style P2 fill:#8338ec,color:#fff
    style P3 fill:#06d6a0,color:#fff
    style P4 fill:#ff9f43,color:#fff
    style R fill:#00ff88,color:#000
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ“– <strong>Bot Interaction Modes:</strong><br><br>
                        Users bots se kaise interact kar sakte hain:<br>
                        â€¢ <strong>Text</strong> â€” Typing karke (most common)<br>
                        â€¢ <strong>Speech</strong> â€” Voice commands se (Alexa, Cortana jaisa)<br>
                        â€¢ <strong>Interactive Cards</strong> â€” Buttons, forms, carousels<br>
                        â€¢ <strong>Images/Videos</strong> â€” Visual content share karna
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h3 class="section-title">Bot Ko Web App Ki Tarah Socho</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Bot ko samajhne ka ek simple way hai: <span class="highlight">Bot = Web Application + Conversational Interface</span>
                    </p>

                    <p class="content-text">
                        Jaise ek normal website HTTP requests handle karti hai, waise hi bot bhi messages handle karta hai. Difference bas itna hai ki:
                    </p>

                    <ul class="bullet-list">
                        <li><strong>Website</strong> â€” User clicks buttons, fills forms â†’ Server responds with HTML pages</li>
                        <li><strong>Bot</strong> â€” User sends messages â†’ Bot responds with conversational replies</li>
                    </ul>

                    <div class="visual-box">
                        <h4>ğŸŒ Bot = Web App with Conversational Interface</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">BOT AS A WEB APPLICATION</div>
                            <div class="mermaid">
flowchart TB
    subgraph Traditional["ğŸ–¥ï¸ TRADITIONAL WEB APP"]
        W1["User clicks button"]
        W2["HTTP Request"]
        W3["Server processes"]
        W4["HTML Response"]
        W1 --> W2 --> W3 --> W4
    end
    
    subgraph BotApp["ğŸ¤– BOT APPLICATION"]
        B1["User sends message"]
        B2["Activity received"]
        B3["Bot processes"]
        B4["Message Response"]
        B1 --> B2 --> B3 --> B4
    end
    
    Note["ğŸ’¡ Same concept,<br/>different interface!"]
    
    Traditional --> Note
    BotApp --> Note
    
    style W1 fill:#3a86ff,color:#fff
    style W4 fill:#3a86ff,color:#fff
    style B1 fill:#00ff88,color:#000
    style B4 fill:#00ff88,color:#000
    style Note fill:#ffd93d,color:#000
                            </div>
                        </div>
                    </div>

                    <p class="content-text">
                        Bots Azure mein host hote hain aur <strong>APIs use karte hain</strong> messages send aur receive karne ke liye. Bot simple bhi ho sakta hai (sirf echo kare) ya complex bhi (multiple AI services use kare)!
                    </p>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ¯ <strong>Bot Capabilities:</strong><br><br>
                        Bots woh sab kar sakte hain jo normal software karta hai:<br>
                        â€¢ <strong>Files read/write</strong> karna<br>
                        â€¢ <strong>Databases</strong> access karna<br>
                        â€¢ <strong>APIs</strong> call karna<br>
                        â€¢ <strong>Computational tasks</strong> perform karna<br><br>
                        <strong>Unique kya hai?</strong> Bots <em>human-like communication mechanisms</em> use karte hain â€” natural language, voice, etc.
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <h3 class="section-title">Azure Bot Service Includes Kya-Kya?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Azure AI Bot Service aur Bot Framework mein ye sab included hota hai:
                    </p>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h5>ğŸ“¦ Bot Framework SDKs</h5>
                            <p>C#, JavaScript, Python mein bots develop karo. (Java SDK retired ho gaya hai)</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ› ï¸ CLI Tools</h5>
                            <p>Command line tools for end-to-end bot development</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ”— Bot Connector Service</h5>
                            <p>Messages aur events relay karta hai bots aur channels ke beech</p>
                        </div>
                        <div class="feature-card">
                            <h5>â˜ï¸ Azure Resources</h5>
                            <p>Bot management aur configuration ke liye cloud resources</p>
                        </div>
                    </div>

                    <p class="content-text" style="margin-top: 1.5rem;">
                        <strong>Additional Azure Services jo bots use kar sakte hain:</strong>
                    </p>

                    <ul class="bullet-list">
                        <li><strong>Azure AI Services</strong> â€” Intelligent applications build karne ke liye (NLP, Vision, etc.)</li>
                        <li><strong>Azure Storage</strong> â€” Cloud storage solution for data</li>
                        <li><strong>Azure Cosmos DB</strong> â€” State management ke liye database</li>
                        <li><strong>Azure Key Vault</strong> â€” Secrets aur credentials manage karne ke liye</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 3: Activities & Turns ==================== -->
        <section class="topic-section" id="activities">
            <header class="topic-header">
                <div class="topic-badge">ğŸ”„ Chapter 3 â€” Core Concepts</div>
                <h2>Activities Aur Turns â€” Bot Communication Ka Core</h2>
                <p class="topic-subtitle">Samjho ki bot messages kaise process karta hai â€” Activity aur Turn ka concept!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h3 class="section-title">Activity Kya Hai? â€” Har Interaction Ek Activity!</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Activity</span> Bot Framework mein communication ki basic unit hai. User (ya channel) aur bot ke beech <strong>har interaction ek activity</strong> ke form mein represent hota hai.
                    </p>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“š <strong>Activity Samjho Simple Example Se:</strong><br><br>
                        Jaise WhatsApp pe jab tum message bhejte ho â€” woh ek <strong>Activity</strong> hai!<br>
                        Jab doosra reply karta hai â€” woh bhi ek <strong>Activity</strong> hai!<br><br>
                        Activities represent kar sakti hain:<br>
                        â€¢ <strong>Message</strong> â€” Text ya media content<br>
                        â€¢ <strong>Conversation Update</strong> â€” Koi join/leave kiya<br>
                        â€¢ <strong>Reaction</strong> â€” Like, emoji response<br>
                        â€¢ <strong>Event</strong> â€” App-to-app notifications
                    </div>

                    <div class="visual-box">
                        <h4>ğŸ“¨ Activity Types â€” Different Interaction Types</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">ACTIVITY TYPES IN BOT FRAMEWORK</div>
                            <div class="mermaid">
flowchart TB
    A["ğŸ“¨ ACTIVITY<br/>Base Unit of Communication"]
    
    A --> M["ğŸ’¬ Message Activity<br/>Text, images, cards"]
    A --> CU["ğŸ‘‹ Conversation Update<br/>User joined/left"]
    A --> R["ğŸ‘ Reaction<br/>Emoji, likes"]
    A --> E["ğŸ”” Event<br/>App notifications"]
    A --> T["âŒ¨ï¸ Typing<br/>User is typing..."]
    
    style A fill:#0078d4,color:#fff
    style M fill:#00ff88,color:#000
    style CU fill:#ff9f43,color:#fff
    style R fill:#8338ec,color:#fff
    style E fill:#ff6b6b,color:#fff
    style T fill:#ffd93d,color:#000
                            </div>
                        </div>
                    </div>

                    <p class="content-text">
                        <strong>Message Activity</strong> sabse common hai â€” isme text, images, cards, speech sab aa sakta hai. Jab user kuch type karta hai ya bot reply karta hai â€” dono <code>message</code> activity hain!
                    </p>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h3 class="section-title">Turn Kya Hai? â€” Baari-Baari Baat Karna</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Jaise real conversation mein log <strong>baari-baari</strong> bolte hain, waise hi bot mein bhi <span class="highlight">Turn</span> concept hai!
                    </p>

                    <div class="hinglish-note">
                        ğŸ’¡ <strong>Turn Ka Matlab:</strong><br><br>
                        Ek <strong>Turn</strong> = User ka incoming activity + Bot ka immediate response<br><br>
                        <em>Think of it like: User ne message bheja â†’ Bot ne process kiya â†’ Bot ne reply diya = 1 Turn complete!</em>
                    </div>

                    <div class="visual-box">
                        <h4>ğŸ”„ Turn â€” Complete Request-Response Cycle</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">TURN = USER MESSAGE + BOT RESPONSE</div>
                            <div class="mermaid">
flowchart LR
    subgraph Turn1["TURN 1"]
        U1["ğŸ‘¤ User: 'Book a table'"]
        B1["ğŸ¤– Bot: 'For how many people?'"]
        U1 --> B1
    end
    
    subgraph Turn2["TURN 2"]
        U2["ğŸ‘¤ User: '4 people'"]
        B2["ğŸ¤– Bot: 'What date?'"]
        U2 --> B2
    end
    
    subgraph Turn3["TURN 3"]
        U3["ğŸ‘¤ User: 'Tomorrow'"]
        B3["ğŸ¤– Bot: 'Booked for 4 tomorrow!'"]
        U3 --> B3
    end
    
    Turn1 --> Turn2 --> Turn3
    
    style U1 fill:#3a86ff,color:#fff
    style U2 fill:#3a86ff,color:#fff
    style U3 fill:#3a86ff,color:#fff
    style B1 fill:#00ff88,color:#000
    style B2 fill:#00ff88,color:#000
    style B3 fill:#00ff88,color:#000
                            </div>
                        </div>
                    </div>

                    <p class="content-text">
                        Har turn mein bot incoming activity receive karta hai, usko process karta hai, aur response generate karta hai. Ye cycle repeat hoti rehti hai jab tak conversation complete nahi ho jaata!
                    </p>

                    <div class="hinglish-note" style="background: rgba(255, 157, 67, 0.1); border-left-color: var(--accent-orange);">
                        âš ï¸ <strong>Important Note:</strong><br><br>
                        Bot ke paas <strong>15 seconds</strong> hote hain response dene ke liye (most channels pe).<br>
                        Agar 15 seconds mein response nahi aaya â†’ <strong>HTTP 504 Gateway Timeout</strong> error!<br><br>
                        <em>Isliye long-running tasks ke liye different patterns use karo (like proactive messaging)</em>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 4: Bot Structure ==================== -->
        <section class="topic-section" id="bot-structure">
            <header class="topic-header">
                <div class="topic-badge">ğŸ—ï¸ Chapter 4 â€” Architecture</div>
                <h2>Bot Application Structure â€” Andar Se Samjho</h2>
                <p class="topic-subtitle">Bot kaise bana hota hai? Adapter, Turn Context, Middleware â€” sab samjho!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h3 class="section-title">Bot Application Ke Main Components</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        SDK do main classes define karta hai jo milke bot application banate hain:
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ§© Bot Application Components</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">BOT APPLICATION STRUCTURE</div>
                            <div class="mermaid">
flowchart TB
    subgraph BotClass["ğŸ¤– BOT CLASS"]
        BC1["Recognizes user input"]
        BC2["Reasons about input"]
        BC3["Performs relevant tasks"]
        BC4["Generates responses"]
    end
    
    subgraph AdapterClass["ğŸ”Œ ADAPTER CLASS"]
        AC1["Handles channel connectivity"]
        AC2["Middleware pipeline"]
        AC3["Calls turn handler"]
        AC4["Catches errors"]
    end
    
    subgraph StateClass["ğŸ’¾ STATE CLASSES"]
        SC1["Storage layer"]
        SC2["Bot State objects"]
        SC3["Property accessors"]
    end
    
    Channel["ğŸŒ Channel<br/>(Teams, Slack, etc.)"]
    
    Channel <--> AdapterClass
    AdapterClass <--> BotClass
    BotClass <--> StateClass
    
    style Channel fill:#0078d4,color:#fff
    style BC1 fill:#00ff88,color:#000
    style AC1 fill:#ff9f43,color:#fff
    style SC1 fill:#8338ec,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ“š <strong>Components Samjho:</strong><br><br>
                        <strong>1. Bot Class</strong> â€” Tumhara main logic yahaan rehta hai<br>
                        â†’ User ka input recognize karo<br>
                        â†’ Decide karo kya karna hai<br>
                        â†’ Response generate karo<br><br>
                        
                        <strong>2. Adapter Class</strong> â€” Channel se connectivity handle karta hai<br>
                        â†’ Messages receive karo<br>
                        â†’ Middleware se guzaro<br>
                        â†’ Bot ko call karo<br><br>
                        
                        <strong>3. State Classes</strong> â€” Data persistence<br>
                        â†’ Conversation yaad rakho<br>
                        â†’ User info store karo
                    </div>
                </div>
            </div>

            <div class="section" id="adapter">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h3 class="section-title">Bot Adapter â€” Gateway to Channels</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Adapter</span> wo component hai jo channel se incoming requests handle karta hai aur bot tak pahunchata hai. Ye SDK runtime ka core hota hai!
                    </p>

                    <p class="content-text">
                        <strong>Adapter ka process activity method</strong> turn start karta hai:
                    </p>

                    <ul class="bullet-list">
                        <li>Request body (activity as JSON) aur headers receive karo</li>
                        <li>Authentication header validate karo</li>
                        <li>Turn ke liye <strong>context object</strong> create karo</li>
                        <li>Context ko <strong>middleware pipeline</strong> se guzaro</li>
                        <li>Finally bot ke <strong>turn handler</strong> ko call karo</li>
                    </ul>

                    <div class="visual-box">
                        <h4>ğŸ”„ Adapter Flow â€” Step by Step</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">ADAPTER PROCESSING FLOW</div>
                            <div class="mermaid">
flowchart TB
    A["ğŸ“¥ HTTP POST Request<br/>(Activity as JSON)"]
    B["ğŸ” Validate Auth Header"]
    C["ğŸ« Create Turn Context"]
    D["âš™ï¸ Middleware Pipeline"]
    E["ğŸ¤– Bot Turn Handler"]
    F["ğŸ“¤ Send Response"]
    
    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    
    style A fill:#3a86ff,color:#fff
    style B fill:#ff6b6b,color:#fff
    style C fill:#ffd93d,color:#000
    style D fill:#8338ec,color:#fff
    style E fill:#00ff88,color:#000
    style F fill:#0078d4,color:#fff
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="turn-context">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <h3 class="section-title">Turn Context â€” Information Ka Carrier</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Turn Context</span> SDK ka sabse important abstraction hai! Ye activity ke baare mein saari information carry karta hai â€” sender, receiver, channel, aur processing ke liye needed data.
                    </p>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ’¡ <strong>Turn Context Ka Kaam:</strong><br><br>
                        1. <strong>Inbound activity</strong> ko middleware aur bot logic tak le jaata hai<br>
                        2. <strong>Outbound activities</strong> send karne ka mechanism provide karta hai<br>
                        3. Har layer mein <strong>information add</strong> karne ki capability deta hai<br><br>
                        
                        <em>Simple words mein: Turn Context = Activity ka wrapper jo extra powers deta hai!</em>
                    </div>

                    <p class="content-text">
                        Turn context <code>send</code>, <code>update</code>, aur <code>delete</code> activity methods provide karta hai jo bot ko responses bhejne mein help karte hain.
                    </p>
                </div>
            </div>

            <div class="section" id="middleware">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <h3 class="section-title">Middleware â€” Processing Pipeline</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Middleware</span> ek linear set of components hai jo activity process hone se <strong>pehle aur baad</strong> mein execute hote hain. Ye nested execution follow karta hai â€” jaise <strong>onion ke layers!</strong> ğŸ§…
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ§… Middleware Pipeline â€” Onion Architecture</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">MIDDLEWARE = NESTED EXECUTION (LIKE ONION)</div>
                            <div class="mermaid">
flowchart TB
    subgraph Pipeline["MIDDLEWARE PIPELINE"]
        direction TB
        M1["ğŸ”µ Middleware 1 (Before)"]
        M2["ğŸŸ£ Middleware 2 (Before)"]
        M3["ğŸŸ¢ Middleware 3 (Before)"]
        Bot["ğŸ¤– BOT TURN HANDLER"]
        M3B["ğŸŸ¢ Middleware 3 (After)"]
        M2B["ğŸŸ£ Middleware 2 (After)"]
        M1B["ğŸ”µ Middleware 1 (After)"]
        
        M1 --> M2
        M2 --> M3
        M3 --> Bot
        Bot --> M3B
        M3B --> M2B
        M2B --> M1B
    end
    
    In["ğŸ“¥ Incoming Activity"]
    Out["ğŸ“¤ Outgoing Response"]
    
    In --> M1
    M1B --> Out
    
    style In fill:#3a86ff,color:#fff
    style Out fill:#00ff88,color:#000
    style Bot fill:#ffd93d,color:#000
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        ğŸ“š <strong>Middleware Use Cases:</strong><br><br>
                        â€¢ <strong>Logging</strong> â€” Har request/response log karo<br>
                        â€¢ <strong>Authentication</strong> â€” User verify karo<br>
                        â€¢ <strong>Translation</strong> â€” Languages translate karo<br>
                        â€¢ <strong>Error Handling</strong> â€” Errors gracefully handle karo<br>
                        â€¢ <strong>State Loading</strong> â€” Conversation state load karo
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” 17.multilingual-bot middleware sample se!</strong>
                    </div>

                    <pre class="language-python line-numbers"><code># Custom Middleware â€” from 17.multilingual-bot sample
from typing import Callable, Awaitable, List
from botbuilder.core import Middleware, TurnContext
from botbuilder.schema import Activity, ActivityTypes

class TranslationMiddleware(Middleware):
    """
    Middleware â€” Har request ke pehle aur baad process karo!
    Ye example translation middleware hai jo incoming/outgoing messages translate karta hai.
    """
    
    def __init__(self, translator, user_state):
        self.translator = translator
        self.language_preference_accessor = user_state.create_property("LanguagePreference")
    
    async def on_turn(
        self, 
        context: TurnContext, 
        logic: Callable[[TurnContext], Awaitable]  # next() function
    ):
        """
        on_turn â€” Ye har turn pe call hota hai!
        Pehle incoming process karo, phir next() call karo, phir outgoing process karo.
        """
        
        # ===== BEFORE (Incoming Message) =====
        should_translate = await self._should_translate(context)
        
        if should_translate and context.activity.type == ActivityTypes.message:
            # User ka message English mein translate karo (bot ko samajh aaye)
            context.activity.text = await self.translator.translate(
                context.activity.text, 
                target_language="en"  # Default language
            )
        
        # ===== REGISTER SEND HANDLER (For Outgoing) =====
        async def on_send_activities(ctx, activities, next_send):
            """Jab bot reply bheje, user ki language mein translate karo"""
            user_language = await self.language_preference_accessor.get(ctx, "en")
            
            if user_language != "en":
                for activity in activities:
                    if activity.type == ActivityTypes.message:
                        activity.text = await self.translator.translate(
                            activity.text, 
                            target_language=user_language
                        )
            
            return await next_send()
        
        context.on_send_activities(on_send_activities)
        
        # ===== CALL NEXT (Bot Logic) =====
        await logic()  # Ye bot ka actual code run karega
        
        # ===== AFTER (Bot logic ke baad) =====
        # Yahan additional cleanup ya logging kar sakte ho</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 5: State Management ==================== -->
        <section class="topic-section" id="state-intro">
            <header class="topic-header">
                <div class="topic-badge">ğŸ’¾ Chapter 5 â€” State Management</div>
                <h2>State Management â€” Conversation Ko Yaad Rakho!</h2>
                <p class="topic-subtitle">Bot stateless hai lekin conversation yaad rakhna hai â€” ye kaise hota hai?</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h3 class="section-title">State Kyun Zaroori Hai?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Web apps ki tarah, bot bhi <strong>inherently stateless</strong> hota hai â€” matlab har request independent hai, bot khud se kuch yaad nahi rakhta!
                    </p>

                    <p class="content-text">
                        Lekin meaningful conversation ke liye <span class="highlight">state maintain karna zaroori hai</span>:
                    </p>

                    <ul class="bullet-list">
                        <li>User se pehle kya baat hui yaad rakho</li>
                        <li>User ki preferences store karo</li>
                        <li>Multi-turn conversation mein context maintain karo</li>
                        <li>Personalized experience provide karo</li>
                    </ul>

                    <div class="hinglish-note" style="background: rgba(255, 157, 67, 0.1); border-left-color: var(--accent-orange);">
                        ğŸ¯ <strong>Real Example:</strong><br><br>
                        User: "Book a flight to Delhi"<br>
                        Bot: "What date?"<br>
                        User: "Tomorrow"<br>
                        Bot: "What time?"<br>
                        User: "Morning"<br><br>
                        
                        Yahaan bot ko <strong>yaad rakhna padega</strong>:<br>
                        â†’ Destination = Delhi<br>
                        â†’ Date = Tomorrow<br>
                        â†’ Time = Morning<br><br>
                        
                        <em>Bina state ke, har turn pe bot bhool jayega ki user kya chahta hai!</em>
                    </div>
                </div>
            </div>

            <div class="section" id="storage-layer">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h3 class="section-title">Storage Layer â€” Data Kahaan Store Hota Hai?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Storage Layer</span> actual physical storage hai jahan state information save hoti hai. Bot Framework SDK kuch ready-made implementations deta hai:
                    </p>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h5>ğŸ§ª Memory Storage</h5>
                            <p>In-memory storage â€” <strong>sirf testing ke liye!</strong> Bot restart hone pe data gayab!</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ“¦ Azure Blob Storage</h5>
                            <p>Azure Blob Storage object database se connect karo</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ—„ï¸ Azure Cosmos DB</h5>
                            <p>Partitioned Cosmos DB NoSQL database â€” production ke liye best!</p>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        âš ï¸ <strong>Important:</strong><br>
                        <code>Memory Storage</code> sirf <strong>local testing</strong> ke liye hai â€” production mein kabhi use mat karo! Data volatile hai aur bot restart pe sab gayab ho jayega.
                    </div>
                </div>
            </div>

            <div class="section" id="state-types">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <h3 class="section-title">State Types â€” 3 Buckets of State</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        SDK teen pre-defined <span class="highlight">"buckets"</span> provide karta hai state organize karne ke liye:
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ“¦ Three State Buckets</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">STATE TYPES â€” DIFFERENT SCOPES</div>
                            <div class="mermaid">
flowchart TB
    subgraph UserState["ğŸ‘¤ USER STATE"]
        US1["Scope: User + Channel"]
        US2["Same user, any conversation"]
        US3["Example: User preferences,<br/>name, settings"]
    end
    
    subgraph ConvState["ğŸ’¬ CONVERSATION STATE"]
        CS1["Scope: Conversation"]
        CS2["Any user in this conversation"]
        CS3["Example: Current topic,<br/>which question asked"]
    end
    
    subgraph PrivateState["ğŸ”’ PRIVATE CONVERSATION STATE"]
        PS1["Scope: User + Conversation"]
        PS2["Specific user in specific conv"]
        PS3["Example: Individual scores<br/>in group quiz"]
    end
    
    style US1 fill:#3a86ff,color:#fff
    style CS1 fill:#00ff88,color:#000
    style PS1 fill:#8338ec,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ“š <strong>Kab Kaunsa State Use Karo:</strong><br><br>
                        <strong>User State</strong> â€” User-specific info jo conversation ke baad bhi rahe:<br>
                        â†’ Name, preferences, alarm settings, language preference<br><br>
                        
                        <strong>Conversation State</strong> â€” Current conversation ka context:<br>
                        â†’ Konsa question pucha, current topic kya hai<br><br>
                        
                        <strong>Private Conversation State</strong> â€” Group mein individual tracking:<br>
                        â†’ Classroom quiz mein har student ka score alag
                    </div>
                </div>
            </div>

            <div class="section" id="state-accessors">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <h3 class="section-title">State Property Accessors â€” Read/Write Kaise Karo?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">State Property Accessors</span> actual interface hain jo state properties read/write karte hain. Ye <code>get</code>, <code>set</code>, aur <code>delete</code> methods provide karte hain.
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ”„ State Accessor Methods</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">STATE ACCESSOR WORKFLOW</div>
                            <div class="mermaid">
flowchart TB
    subgraph Get["GET Method"]
                        G1["1. Request from cache"]
                        G2["2. If not in cache, get from storage"]
                        G3["3. Return property"]
                        G1 --> G2 --> G3
                    end
                    
                    subgraph Set["SET Method"]
                        S1["1. Update cache with new value"]
                        S2["2. Cache ready for save"]
                        S1 --> S2
                    end
                    
                    subgraph Save["SAVE CHANGES"]
                        SV1["1. Check changes in cache"]
                        SV2["2. Write to storage"]
                        SV1 --> SV2
                    end
                    
                    Get --> Set
                    Set --> Save
                    
                    style G1 fill:#3a86ff,color:#fff
                    style S1 fill:#ff9f43,color:#fff
                    style SV2 fill:#00ff88,color:#000
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(255, 107, 107, 0.1); border-left-color: var(--accent-red);">
                        âš ï¸ <strong>Critical Point â€” "Last Write Wins":</strong><br><br>
                        Bot state <strong>"last write wins"</strong> behavior follow karta hai â€” matlab jo last mein save hoga wahi final hoga!<br><br>
                        
                        Scaled-out scenarios mein (multiple instances) ye problem create kar sakta hai. Agar concurrency ya latency hai toh careful rahna padega!
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” 45.state-management sample se!</strong>
                    </div>

                    <pre class="language-python line-numbers"><code># State Management Bot â€” from 45.state-management sample
from botbuilder.core import ActivityHandler, ConversationState, TurnContext, UserState

# Data Models â€” state mein kya store karna hai
class UserProfile:
    def __init__(self):
        self.name = None  # User ka naam

class ConversationData:
    def __init__(self):
        self.timestamp = None      # Message time
        self.channel_id = None     # Channel info
        self.prompted_for_user_name = False  # Flag


class StateManagementBot(ActivityHandler):
    """
    State Management â€” User aur Conversation data persist karo!
    Restart ke baad bhi data yaad rahe.
    """
    
    def __init__(self, conversation_state: ConversationState, user_state: UserState):
        # State objects store karo
        self.conversation_state = conversation_state
        self.user_state = user_state
        
        # Accessors create karo â€” ye read/write ke liye use honge
        self.conversation_data_accessor = conversation_state.create_property("ConversationData")
        self.user_profile_accessor = user_state.create_property("UserProfile")
    
    async def on_turn(self, turn_context: TurnContext):
        await super().on_turn(turn_context)
        
        # âš ï¸ IMPORTANT: Har turn ke end pe save karo!
        await self.conversation_state.save_changes(turn_context)
        await self.user_state.save_changes(turn_context)
    
    async def on_message_activity(self, turn_context: TurnContext):
        # State se data get karo (default object milega agar nahi hai)
        user_profile = await self.user_profile_accessor.get(turn_context, UserProfile)
        conversation_data = await self.conversation_data_accessor.get(turn_context, ConversationData)
        
        if user_profile.name is None:
            if conversation_data.prompted_for_user_name:
                # User ne naam diya â€” save karo!
                user_profile.name = turn_context.activity.text
                await turn_context.send_activity(f"Thanks {user_profile.name}!")
                conversation_data.prompted_for_user_name = False
            else:
                # Naam puchho
                await turn_context.send_activity("What is your name?")
                conversation_data.prompted_for_user_name = True
        else:
            # User ka naam yaad hai! ğŸ‰
            await turn_context.send_activity(f"Hello {user_profile.name}! How can I help?")</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Enterprise C# Code â€” Bot State Controller API!</strong><br>
                        Ye code Azure Bot Service Intercom backend se hai â€” real state management endpoints!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// Bot State Controller â€” Enterprise REST API (From Intercom Codebase)
// Ye deprecated state APIs hain but important to understand architecture!

[RoutePrefix("v3/botstate")]
[ValidateModel]
[HandleAPIException]
public class BotStateController : ApiController
{
    /// &lt;summary&gt;
    /// Get user data across ALL conversations
    /// User ki global preferences ya settings get karo
    /// &lt;/summary&gt;
    [HttpGet]
    [Route("{channelId}/users/{userId}")]
    [ResponseType(typeof(BotData))]
    [Obsolete("Use BotBuilder state management instead")]
    public async Task&lt;HttpResponseMessage&gt; GetUserData(string channelId, string userId)
    {
        return Request.CreateResponse(HttpStatusCode.OK);
    }

    /// &lt;summary&gt;
    /// Get conversation-specific data for ALL users in that conversation
    /// Group conversation ka shared state
    /// &lt;/summary&gt;
    [HttpGet]
    [Route("{channelId}/conversations/{conversationId}")]
    [ResponseType(typeof(BotData))]
    public async Task&lt;HttpResponseMessage&gt; GetConversationData(string channelId, string conversationId)
    {
        return Request.CreateResponse(HttpStatusCode.OK);
    }

    /// &lt;summary&gt;
    /// Get PRIVATE data â€” specific user + specific conversation
    /// Most common use case â€” user ke conversation-specific state
    /// &lt;/summary&gt;
    [HttpGet]
    [Route("{channelId}/conversations/{conversationId}/users/{userId}")]
    public async Task&lt;HttpResponseMessage&gt; GetPrivateConversationData(
        string channelId, string conversationId, string userId)
    {
        return Request.CreateResponse(HttpStatusCode.OK);
    }
}</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Conversation Manager â€” Enterprise Session Management!</strong><br>
                        DirectLine ke through conversation session kaise manage hote hain!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// Conversation Manager â€” From DirectLine Extension (Intercom Enterprise Code)
// Real-time conversation session management with WebSocket support

public class ConversationManager : IConversationManager
{
    private readonly IBotInfo _botInfo;
    private readonly IConversationEvictionPolicy _evictionPolicy;
    
    // Thread-safe dictionary for active conversations
    private readonly ConcurrentDictionary&lt;string, ConversationContext&gt; _conversations;

    public ConversationManager(IBotInfo botInfo, IConversationEvictionPolicy evictionPolicy)
    {
        _botInfo = botInfo;
        _evictionPolicy = evictionPolicy;
        _conversations = new ConcurrentDictionary&lt;string, ConversationContext&gt;();

        // Background eviction policy monitor
        _evictionPolicy.Monitor(_conversations);
    }

    /// &lt;summary&gt;
    /// Naya conversation create karo â€” DirectLine client ke liye
    /// &lt;/summary&gt;
    public ConversationContext CreateConversation(string siteId, string conversationId, bool isReconnect = false)
    {
        if (conversationId == null)
            conversationId = CreateConversationId();  // Generate unique ID

        var conversationContext = new ConversationContext(conversationId, siteId, isReconnect);

        // Bot ko conversation mein add karo
        conversationContext.TryAddUser(_botInfo.Bot.Configuration.BotId);

        // Thread-safe add/update
        conversationContext = _conversations.AddOrUpdate(
            conversationContext.ConversationId, 
            conversationContext, 
            (id, existing) => existing);

        return conversationContext;
    }

    /// &lt;summary&gt;
    /// WebSocket connection manage karo for real-time messages
    /// &lt;/summary&gt;
    public void TryAddSocket(string conversationId, WebSocketServer socketServer)
    {
        if (_conversations.TryGetValue(conversationId, out ConversationContext conversationContext))
        {
            // Disconnect handler register karo
            socketServer.Disconnected += (sender, args) =&gt;
            {
                conversationContext.TryRemoveSocket(socketServer);
            };
            
            conversationContext.TryAddSocket(socketServer);
        }
        else
        {
            throw new ArgumentException("conversationId not found");
        }
    }

    /// &lt;summary&gt;
    /// Conversation end karo â€” cleanup
    /// &lt;/summary&gt;
    public bool RemoveConversation(string conversationId)
    {
        return _conversations.Remove(conversationId, out ConversationContext _);
    }

    public static string CreateConversationId()
    {
        return IdFactory.CreateId() + IdFactory.CreateId();  // Long unique ID
    }
}</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 6: Channels ==================== -->
        <section class="topic-section" id="channels-intro">
            <header class="topic-header">
                <div class="topic-badge">ğŸŒ Chapter 6 â€” Channels</div>
                <h2>Channels â€” Bot Ko Duniya Se Connect Karo!</h2>
                <p class="topic-subtitle">Ek bot banao, multiple platforms pe deploy karo â€” Teams, Slack, Facebook, WhatsApp!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h3 class="section-title">Channel Kya Hai?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Channel</span> ek connection hai communication application aur bot ke beech. Bot ko Azure mein register karte ho, aur phir channels configure karte ho taaki bot users se communicate kar sake.
                    </p>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ’¡ <strong>Channel-Agnostic Development:</strong><br><br>
                        Bot Framework ka magic ye hai ki tum <strong>ek baar code likho</strong>, aur woh <strong>multiple channels pe kaam kare!</strong><br><br>
                        
                        Framework automatically messages ko <strong>normalize</strong> karta hai â€” matlab:<br>
                        â€¢ Facebook se aaye message ka format â†’ Bot Framework Activity schema<br>
                        â€¢ Teams se aaye message ka format â†’ Bot Framework Activity schema<br><br>
                        
                        <em>Tumhe har platform ka alag code nahi likhna padta!</em>
                    </div>

                    <div class="visual-box">
                        <h4>ğŸ”„ Channel Normalization â€” One Bot, Many Platforms</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">BOT CONNECTOR SERVICE â€” MESSAGE NORMALIZATION</div>
                            <div class="mermaid">
flowchart TB
    subgraph Channels["DIFFERENT CHANNELS"]
                        T["ğŸ’¬ Teams"]
                        F["ğŸ“˜ Facebook"]
                        S["ğŸ’¼ Slack"]
                        W["ğŸ“± WhatsApp"]
                    end
                    
                    Connector["ğŸ”— Bot Connector Service<br/>Normalizes all messages<br/>to Activity Schema"]
                    
                    Bot["ğŸ¤– YOUR BOT<br/>Receives unified format"]
                    
                    Channels --> Connector
                    Connector --> Bot
                    Bot --> Connector
                    Connector --> Channels
                    
                    style Connector fill:#0078d4,color:#fff
                    style Bot fill:#00ff88,color:#000
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="channels-list">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h3 class="section-title">Available Channels â€” Kahaan-Kahaan Deploy Kar Sakte Ho?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Bot Framework bahut saare channels support karta hai. Kuch popular ones:
                    </p>

                    <div class="channel-grid">
                        <div class="channel-item">
                            <div class="icon">ğŸ’¬</div>
                            <div class="name">Microsoft Teams</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ“˜</div>
                            <div class="name">Facebook</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ’¼</div>
                            <div class="name">Slack</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">âœˆï¸</div>
                            <div class="name">Telegram</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ’¬</div>
                            <div class="name">Web Chat</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ“§</div>
                            <div class="name">Email</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ“±</div>
                            <div class="name">SMS (Twilio)</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ¤</div>
                            <div class="name">Alexa</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ’š</div>
                            <div class="name">LINE</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ’¬</div>
                            <div class="name">WeChat</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ”—</div>
                            <div class="name">Direct Line</div>
                        </div>
                        <div class="channel-item">
                            <div class="icon">ğŸ“§</div>
                            <div class="name">Outlook</div>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        ğŸ“ <strong>Channel Configure Kaise Karo:</strong><br><br>
                        1. Azure Portal pe sign in karo<br>
                        2. Apna bot select karo<br>
                        3. Settings â†’ Channels pe jao<br>
                        4. Jo channel chahiye uska icon click karo<br>
                        5. Channel-specific configuration complete karo<br><br>
                        
                        <em>Note: Har channel ke apne requirements hote hain â€” Facebook ke liye app registration, Teams ke liye tenant approval, etc.</em>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Enterprise C# Code â€” Real WhatsApp Channel Implementation!</strong><br>
                        Ye code Azure Bot Service Intercom codebase se hai â€” production-grade channel connector!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// WhatsApp Channel - Incoming Message Mapper (Enterprise Code)
// From: Intercom/Channels/WhatsAppChannel - Production ABS Infrastructure

public class WhatsAppIncomingMessageMapper
{
    private IIdFactory _idFactory;
    private IAdvancedLogger _advancedLogger;

    public WhatsAppIncomingMessageMapper(IIdFactory idFactory, IAdvancedLogger advancedLogger)
    {
        _idFactory = idFactory ?? throw new ArgumentNullException(nameof(idFactory));
        _advancedLogger = advancedLogger ?? throw new ArgumentNullException(nameof(advancedLogger));
    }

    /// &lt;summary&gt;
    /// WhatsApp message ko Bot Framework Activity mein convert karo!
    /// Ye normalization hai - har channel ka message same format mein aata hai bot ke paas.
    /// &lt;/summary&gt;
    public IMessageActivity WhatsAppMessageEnvelopeToConversationUpdateAsync(
        APIContext apiContext, 
        WhatsAppMessageRequest whatsAppEvent, 
        ChannelAccount from, 
        ChannelAccount recipient, 
        ConversationAccount conversation = null)
    {
        // Activity create karo â€” standard Bot Framework format
        var updateActivity = Activity.CreateMessageActivity();
        updateActivity.Id = _idFactory.CreateId();
        updateActivity.From = from;
        updateActivity.Conversation = conversation;
        updateActivity.Recipient = recipient;
        updateActivity.Timestamp = whatsAppEvent.EventTime;
        updateActivity.ChannelId = ChannelId.WhatsApp;  // Channel identifier

        // Message type ke hisaab se handle karo
        if (whatsAppEvent.Data.MessageType == WhatsAppContentType.Text)
        {
            updateActivity.Type = ActivityTypes.Message;
            updateActivity.Text = whatsAppEvent.Data.Content;  // User ka text
        }
        else if (whatsAppEvent.Data.Interactive != null)
        {
            // Interactive buttons/list response
            var interactiveMessageRenderer = new InteractiveMessageRenderer(whatsAppEvent.Data.Interactive);
            updateActivity.Value = interactiveMessageRenderer.TransformToABSActionResponse();
        }
        else if (whatsAppEvent.Data.Media != null)
        {
            // Media attachments (images, documents, etc.)
            List&lt;Attachment&gt; attachments = new List&lt;Attachment&gt;();
            attachments.Add(new Attachment()
            {
                Name = whatsAppEvent.Data.Media.FileName,
                Content = new WhatsAppAttachmentData(whatsAppEvent.Data.Media.Id),
                ContentType = whatsAppEvent.Data.Media.MimeType,
            });
            updateActivity.Attachments = attachments;
        }

        return updateActivity;
    }
}</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>WhatsApp to Bot Connector â€” Message Delivery</strong><br>
                        Bot tak message kaise pahunchta hai â€” ye enterprise connector code!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// WhatsApp to Bot Connector â€” From Intercom Enterprise Codebase
// Ye class WhatsApp se message receive karke Bot ko forward karta hai

public class WhatsAppToBotConnector
{
    private readonly BotStore _storage;
    private readonly WhatsAppIncomingMessageMapper _whatsappIncomingMessageMapper;
    private readonly IARCertificateCache _jwtARCertCache;  // JWT Certificate for auth

    /// &lt;summary&gt;
    /// WhatsApp se message aaya â€” Bot ko bhejo!
    /// Certificate-based authentication ke saath secure delivery.
    /// &lt;/summary&gt;
    public async Task&lt;HttpResponseMessage&gt; SendChannelDataToBotAsync(
        IBotApiFactory botApiFactory, 
        APIContext context, 
        WhatsAppMessageRequest whatsappEvent, 
        CancellationToken cancellationToken)
    {
        HttpResponseMessage response = null;

        // Duplicate message check â€” same message dobara process na ho
        var key = $"{whatsappEvent.Id}-{whatsappEvent.Data.From}-{context.BotId}";
        
        await _doOnce.DoOnce(key, async () =&gt;
        {
            // Bot API create karo with proper authentication
            var botApi = new BotAPI(
                IntercomEnvironment.Current,
                new WhatsAppApiStorage(),
                new ChannelConfiguration(),
                certificate: null,  // Set below
                ReportingSenderPerCloud.Instance.GetSettings(),
                BillingPolicyPerCloud.Instance.GetSettings());

            // JWT Certificate load karo for secure communication
            var certificate = await _jwtARCertCache.PickARCert(
                _autoRotationFlightingHelper, 
                OpenIdFlavor.JWTAR, 
                context.BotId).ConfigureAwait(false);
            
            botApi.JwtSigningCertificate = certificate;

            // Bot ko message bhejo!
            response = await ProcessMessage(botApi, context, whatsappEvent, cancellationToken);
            
            return true;
        }).ConfigureAwait(false);

        return response;
    }

    private async Task&lt;HttpResponseMessage&gt; ProcessMessage(...)
    {
        // Bot lookup from storage
        BotService bot = await _storage.GetBotInGeoAsync(apiContext.BotId, useCache: true);
        
        if (bot == null)
            throw new APIException(HttpStatusCode.NotFound, "Bot not found");

        // Conversation ID generate karo (encrypted for security)
        var conversationAccount = new ConversationAccount(
            ConversationHelper.GetConversationId(eventFromEncrypted, eventTo, apiContext.BotId));

        // Activity create karo via mapper
        IActivity activity = _whatsappIncomingMessageMapper
            .WhatsAppMessageEnvelopeToConversationUpdateAsync(
                apiContext, whatsappEvent, from, recipient, conversationAccount);

        // Bot ko forward karo!
        return await botApi.PostActivityToBotAsync(activity);
    }
}</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 7: Dialogs Library ==================== -->
        <section class="topic-section" id="dialogs">
            <header class="topic-header">
                <div class="topic-badge">ğŸ’¬ Chapter 7 â€” Dialogs</div>
                <h2>Dialogs Library â€” Multi-Turn Conversations!</h2>
                <p class="topic-subtitle">Complex conversations manage karo â€” step-by-step user input gather karo!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h3 class="section-title">Dialog Kya Hai?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Dialog</span> SDK mein ek central concept hai jo <strong>long-running conversations</strong> manage karta hai. Ek dialog ek task represent karta hai jo complete hone tak multiple turns le sakta hai.
                    </p>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“š <strong>Dialog = Function/Method Jaisa!</strong><br><br>
                        Programming mein jaise function hota hai, waise hi Dialog hai:<br>
                        â€¢ <strong>Arguments pass</strong> kar sakte ho (options)<br>
                        â€¢ <strong>Return value</strong> mil sakti hai (result)<br>
                        â€¢ <strong>Begin, Continue, End</strong> â€” lifecycle manage hoti hai<br><br>
                        
                        <em>Example: Flight booking dialog â€” destination, date, passengers sab step-by-step puchega!</em>
                    </div>

                    <div class="visual-box">
                        <h4>ğŸ“š Dialog Types</h4>
                        <div class="feature-grid">
                            <div class="feature-card">
                                <h5>ğŸ”µ Component Dialog</h5>
                                <p>Container dialog jo multiple dialogs ko group karta hai. Reusable!</p>
                            </div>
                            <div class="feature-card">
                                <h5>ğŸ”µ Waterfall Dialog</h5>
                                <p>Linear steps â€” ek ke baad ek questions puchta hai</p>
                            </div>
                            <div class="feature-card">
                                <h5>ğŸ”µ Prompt Dialog</h5>
                                <p>User se specific input maangta hai (text, number, choice, etc.)</p>
                            </div>
                            <div class="feature-card">
                                <h5>ğŸ”µ Adaptive Dialog</h5>
                                <p>Flexible conversation flow â€” Composer ke liye designed</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h3 class="section-title">Dialog Stack â€” Call Stack Jaisa!</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Dialogs ek <span class="highlight">stack</span> structure mein organized hote hain â€” jaise function call stack!
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ“š Dialog Stack Operations</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">DIALOG STACK â€” PUSH/POP OPERATIONS</div>
                            <div class="mermaid">
flowchart TB
    subgraph Stack["DIALOG STACK"]
        D1["ğŸ”µ Root Dialog<br/>(Main)"]
        D2["ğŸŸ¢ Booking Dialog<br/>(Child)"]
        D3["ğŸŸ¡ Date Prompt<br/>(Top - Active)"]
    end
    
    Push["BEGIN DIALOG<br/>â†’ Push to stack"]
    Pop["END DIALOG<br/>â†’ Pop from stack"]
    
    Push --> Stack
    Stack --> Pop
    
    Note["ğŸ’¡ Top dialog = Active Dialog<br/>Only active dialog receives input"]
    
    style D3 fill:#ffd93d,color:#000
    style D2 fill:#00ff88,color:#000
    style D1 fill:#3a86ff,color:#fff
    style Note fill:#8338ec,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        ğŸ’¡ <strong>Stack Operations:</strong><br><br>
                        â€¢ <strong>Begin Dialog</strong> â€” Naya dialog push karo stack pe<br>
                        â€¢ <strong>End Dialog</strong> â€” Current dialog pop karo, parent ko control<br>
                        â€¢ <strong>Replace Dialog</strong> â€” Current ko replace karo (loop ke liye useful)<br>
                        â€¢ <strong>Cancel All</strong> â€” Saare dialogs clear karo
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 8: Waterfall Dialogs ==================== -->
        <section class="topic-section" id="waterfall">
            <header class="topic-header">
                <div class="topic-badge">ğŸŒŠ Chapter 8 â€” Waterfall Dialogs</div>
                <h2>Waterfall Dialogs â€” Step-by-Step Conversation!</h2>
                <p class="topic-subtitle">Linear conversation flow â€” paani ki tarah ek step se doosre pe!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸŒŠ</div>
                    <h3 class="section-title">Waterfall Dialog Kaise Kaam Karta Hai?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Waterfall Dialog</span> ek sequence of steps define karta hai. Har step ek async function hai jo user se input leta hai aur next step ko result pass karta hai.
                    </p>

                    <div class="visual-box">
                        <h4>ğŸŒŠ Waterfall Flow Example â€” Flight Booking</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">WATERFALL DIALOG â€” SEQUENTIAL STEPS</div>
                            <div class="mermaid">
flowchart TB
    S1["Step 1: Ask Destination<br/>'Where do you want to go?'"]
    S2["Step 2: Ask Date<br/>'What date?'"]
    S3["Step 3: Ask Passengers<br/>'How many passengers?'"]
    S4["Step 4: Confirm<br/>'Book flight to Delhi on 25th for 2?'"]
    S5["Step 5: Complete<br/>'Flight booked! âœ…'"]
    
    S1 -->|"User: Delhi"| S2
    S2 -->|"User: 25th Jan"| S3
    S3 -->|"User: 2"| S4
    S4 -->|"User: Yes"| S5
    
    style S1 fill:#3a86ff,color:#fff
    style S2 fill:#8338ec,color:#fff
    style S3 fill:#ff9f43,color:#fff
    style S4 fill:#ff6b6b,color:#fff
    style S5 fill:#00ff88,color:#000
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ“š <strong>Waterfall Step Context Properties:</strong><br><br>
                        Har step mein <code>stepContext</code> milta hai jisme:<br>
                        â€¢ <strong>Options</strong> â€” Dialog start karte waqt pass ki gayi info<br>
                        â€¢ <strong>Values</strong> â€” Previous steps ka collected data<br>
                        â€¢ <strong>Result</strong> â€” Previous step ka result (user input)<br><br>
                        
                        <em>Ye properties use karke tum previous steps ka data access kar sakte ho!</em>
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” 05.multi-turn-prompt sample se!</strong>
                    </div>

                    <pre class="language-python line-numbers"><code># Waterfall Dialog â€” from 05.multi-turn-prompt sample
from botbuilder.dialogs import ComponentDialog, WaterfallDialog, WaterfallStepContext
from botbuilder.dialogs.prompts import TextPrompt, ChoicePrompt, ConfirmPrompt, PromptOptions
from botbuilder.dialogs.choices import Choice
from botbuilder.core import MessageFactory

class UserProfileDialog(ComponentDialog):
    """
    Waterfall Dialog â€” Step by step user se info lo!
    Paani ki tarah ek step se next pe flow karo.
    """
    
    def __init__(self, user_state):
        super().__init__(UserProfileDialog.__name__)
        
        # Prompts add karo â€” ye input lenge
        self.add_dialog(TextPrompt(TextPrompt.__name__))
        self.add_dialog(ChoicePrompt(ChoicePrompt.__name__))
        self.add_dialog(ConfirmPrompt(ConfirmPrompt.__name__))
        
        # Waterfall Dialog â€” steps ka sequence define karo
        self.add_dialog(
            WaterfallDialog(
                "WaterfallDialog",
                [
                    self.transport_step,    # Step 1: Transport mode
                    self.name_step,         # Step 2: Name
                    self.confirm_step,      # Step 3: Confirm
                    self.summary_step       # Step 4: Summary
                ]
            )
        )
        
        self.initial_dialog_id = "WaterfallDialog"
    
    async def transport_step(self, step_context: WaterfallStepContext):
        """Step 1: Transport mode puchho â€” Choice Prompt use karo"""
        return await step_context.prompt(
            ChoicePrompt.__name__,
            PromptOptions(
                prompt=MessageFactory.text("Please enter your mode of transport:"),
                choices=[Choice("Car"), Choice("Bus"), Choice("Bicycle")]
            )
        )
    
    async def name_step(self, step_context: WaterfallStepContext):
        """Step 2: Previous step ka result save karo, naam puchho"""
        # step_context.result = previous step ka output!
        step_context.values["transport"] = step_context.result.value
        
        return await step_context.prompt(
            TextPrompt.__name__,
            PromptOptions(prompt=MessageFactory.text("Please enter your name:"))
        )
    
    async def confirm_step(self, step_context: WaterfallStepContext):
        """Step 3: Naam save karo, confirm karo"""
        step_context.values["name"] = step_context.result
        
        return await step_context.prompt(
            ConfirmPrompt.__name__,
            PromptOptions(prompt=MessageFactory.text("Is this correct?"))
        )
    
    async def summary_step(self, step_context: WaterfallStepContext):
        """Step 4: Summary show karo aur dialog end karo"""
        if step_context.result:  # User ne "Yes" bola
            await step_context.context.send_activity(
                f"Transport: {step_context.values['transport']}\n"
                f"Name: {step_context.values['name']}"
            )
        
        return await step_context.end_dialog()</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 9: Prompts ==================== -->
        <section class="topic-section" id="prompts">
            <header class="topic-header">
                <div class="topic-badge">â“ Chapter 9 â€” Prompts</div>
                <h2>Prompts â€” User Se Input Lo!</h2>
                <p class="topic-subtitle">Different types ke input collect karo â€” text, number, choice, date!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">â“</div>
                    <h3 class="section-title">Prompt Types</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Prompts</span> special dialogs hain jo user se specific type ka input maangte hain. Automatically validation bhi karte hain!
                    </p>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h5>ğŸ“ Text Prompt</h5>
                            <p>General text input â€” naam, address, etc. Returns: string</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ”¢ Number Prompt</h5>
                            <p>Numbers ke liye â€” "ten", "12", "a dozen" sab samjhe! Returns: number</p>
                        </div>
                        <div class="feature-card">
                            <h5>âœ… Confirm Prompt</h5>
                            <p>Yes/No confirmation â€” "haan", "yes", "nope" sab samjhe! Returns: boolean</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ¯ Choice Prompt</h5>
                            <p>Options mein se choose karo â€” buttons ya list. Returns: FoundChoice</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ“… DateTime Prompt</h5>
                            <p>"tomorrow", "next Friday", "10am" â€” natural language dates! Returns: DateTime[]</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ“ Attachment Prompt</h5>
                            <p>Files, images upload karwao. Returns: Attachment[]</p>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(255, 157, 67, 0.1); border-left-color: var(--accent-orange);">
                        ğŸ”„ <strong>Prompt 2-Step Process:</strong><br><br>
                        1. <strong>Ask</strong> â€” User se input maango<br>
                        2. <strong>Validate</strong> â€” Check karo valid hai ya nahi<br>
                        â†’ Valid? âœ… Return value<br>
                        â†’ Invalid? âŒ Retry prompt send karo<br><br>
                        
                        <em>Tum custom validator bhi add kar sakte ho â€” jaise party size 2-12 ke beech hona chahiye!</em>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 10: Activity Handlers ==================== -->
        <section class="topic-section" id="activity-handlers">
            <header class="topic-header">
                <div class="topic-badge">âš¡ Chapter 10 â€” Activity Handlers</div>
                <h2>Activity Handlers â€” Event-Driven Bot!</h2>
                <p class="topic-subtitle">Different activity types ke liye different handlers â€” clean code structure!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">âš¡</div>
                    <h3 class="section-title">Activity Handler Pattern</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Activity Handler</span> ek event-driven way hai bot logic organize karne ka. Har activity type ke liye ek handler method hota hai!
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ“‹ Common Activity Handlers</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">ACTIVITY HANDLERS â€” EVENT-DRIVEN PATTERN</div>
                            <div class="mermaid">
flowchart TB
    Turn["OnTurnAsync<br/>(Master Handler)"]
    
    Turn --> Msg["OnMessageActivityAsync<br/>ğŸ’¬ User messages"]
    Turn --> Conv["OnConversationUpdateActivityAsync<br/>ğŸ‘‹ Join/Leave events"]
    Turn --> React["OnMessageReactionActivityAsync<br/>ğŸ‘ Reactions"]
    Turn --> Event["OnEventActivityAsync<br/>ğŸ”” Events"]
    
    Conv --> Added["OnMembersAddedAsync<br/>Welcome new members"]
    Conv --> Removed["OnMembersRemovedAsync<br/>Goodbye messages"]
    
    style Turn fill:#0078d4,color:#fff
    style Msg fill:#00ff88,color:#000
    style Conv fill:#ff9f43,color:#fff
    style React fill:#8338ec,color:#fff
    style Event fill:#ff6b6b,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“š <strong>Most Used Handlers:</strong><br><br>
                        â€¢ <strong>OnMessageActivityAsync</strong> â€” User ka message handle karo (echo bot)<br>
                        â€¢ <strong>OnMembersAddedAsync</strong> â€” Naye users ko welcome karo<br>
                        â€¢ <strong>OnMembersRemovedAsync</strong> â€” User leave kare toh handle karo<br>
                        â€¢ <strong>OnTokenResponseEventAsync</strong> â€” OAuth token response<br><br>
                        
                        <em>Simply inherit <code>ActivityHandler</code> class aur jo handlers chahiye woh override karo!</em>
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” Bot Framework Samples se!</strong><br>
                        Ye actual code hai <code>botbuilder-samples</code> repo se â€” production-ready!
                    </div>

                    <pre class="language-python line-numbers"><code># Python Echo Bot â€” from 02.echo-bot sample
from botbuilder.core import ActivityHandler, MessageFactory, TurnContext
from botbuilder.schema import ChannelAccount

class EchoBot(ActivityHandler):
    """
    Sabse simple bot â€” user jo bole wahi echo karo!
    ActivityHandler inherit karo aur methods override karo.
    """
    
    # Jab user message bheje
    async def on_message_activity(self, turn_context: TurnContext):
        # Echo back the user's message
        return await turn_context.send_activity(
            MessageFactory.text(f"Echo: {turn_context.activity.text}")
        )
    
    # Jab naya user join kare
    async def on_members_added_activity(
        self, members_added: [ChannelAccount], turn_context: TurnContext
    ):
        for member in members_added:
            # Bot khud ko welcome mat karo!
            if member.id != turn_context.activity.recipient.id:
                await turn_context.send_activity("Hello and welcome!")
</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ’» <strong>C# Version â€” Same Logic:</strong>
                    </div>

                    <pre class="language-csharp line-numbers"><code>// C# Echo Bot â€” from JavaScript sample converted
public class EchoBot : ActivityHandler
{
    // Handle user messages
    protected override async Task OnMessageActivityAsync(
        ITurnContext&lt;IMessageActivity&gt; turnContext, 
        CancellationToken cancellationToken)
    {
        var replyText = $"Echo: {turnContext.Activity.Text}";
        await turnContext.SendActivityAsync(
            MessageFactory.Text(replyText), cancellationToken);
    }

    // Welcome new members
    protected override async Task OnMembersAddedAsync(
        IList&lt;ChannelAccount&gt; membersAdded,
        ITurnContext&lt;IConversationUpdateActivity&gt; turnContext,
        CancellationToken cancellationToken)
    {
        foreach (var member in membersAdded)
        {
            if (member.Id != turnContext.Activity.Recipient.Id)
            {
                await turnContext.SendActivityAsync(
                    MessageFactory.Text("Welcome!"), cancellationToken);
            }
        }
    }
}</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 11: Cards & Attachments ==================== -->
        <section class="topic-section" id="cards">
            <header class="topic-header">
                <div class="topic-badge">ğŸ´ Chapter 11 â€” Cards & Attachments</div>
                <h2>Rich Cards â€” Beautiful Messages!</h2>
                <p class="topic-subtitle">Text se zyada â€” images, buttons, carousels send karo!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ´</div>
                    <h3 class="section-title">Card Types</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Plain text boring hai! <span class="highlight">Rich Cards</span> use karke visually appealing messages bhejo â€” images, buttons, forms sab include kar sakte ho!
                    </p>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h5>ğŸ¦¸ Hero Card</h5>
                            <p>Large image + title + buttons â€” product showcase ke liye perfect!</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ–¼ï¸ Thumbnail Card</h5>
                            <p>Small image + text â€” compact info display</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ§¾ Receipt Card</h5>
                            <p>Order receipt â€” items, prices, total dikhao</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ” Sign-in Card</h5>
                            <p>OAuth login button â€” authentication ke liye</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸµ Audio/Video Card</h5>
                            <p>Media playback â€” inline audio/video</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ  Carousel</h5>
                            <p>Multiple cards side-by-side â€” swipe karke dekho!</p>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        ğŸ’¡ <strong>Card Actions:</strong><br><br>
                        Cards pe buttons add kar sakte ho jo different actions trigger kare:<br>
                        â€¢ <strong>imBack</strong> â€” Message send karo (visible in chat)<br>
                        â€¢ <strong>postBack</strong> â€” Message send karo (hidden from chat)<br>
                        â€¢ <strong>openUrl</strong> â€” External URL kholo<br>
                        â€¢ <strong>call</strong> â€” Phone call initiate karo<br>
                        â€¢ <strong>signin</strong> â€” OAuth flow start karo
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” 06.using-cards sample se!</strong>
                    </div>

                    <pre class="language-python line-numbers"><code># Hero Card banao â€” from 06.using-cards sample
from botbuilder.schema import HeroCard, CardImage, CardAction, ActionTypes
from botbuilder.core import CardFactory

def create_hero_card():
    """
    Hero Card â€” Large image + title + buttons
    Product showcase, welcome messages ke liye best!
    """
    card = HeroCard(
        title="Bot Framework Hero Card",
        images=[
            CardImage(url="https://example.com/image.jpg")
        ],
        buttons=[
            CardAction(
                type=ActionTypes.open_url,
                title="Get Started",
                value="https://docs.microsoft.com/azure/bot-service/"
            ),
            CardAction(
                type=ActionTypes.im_back,  # Message visible in chat
                title="Say Hello",
                value="Hello!"
            )
        ]
    )
    return CardFactory.hero_card(card)

# Receipt Card â€” Order details dikhao
def create_receipt_card():
    """
    Receipt Card â€” E-commerce orders ke liye perfect!
    Items, prices, tax, total sab dikhao.
    """
    card = ReceiptCard(
        title="John Doe",
        facts=[
            Fact(key="Order Number", value="1234"),
            Fact(key="Payment Method", value="VISA 5555-****"),
        ],
        items=[
            ReceiptItem(title="Data Transfer", price="$38.45", quantity="368"),
            ReceiptItem(title="App Service", price="$45.00", quantity="720"),
        ],
        tax="$7.50",
        total="$90.95"
    )
    return CardFactory.receipt_card(card)</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 12: Adaptive Cards ==================== -->
        <section class="topic-section" id="adaptive-cards">
            <header class="topic-header">
                <div class="topic-badge">ğŸ“‹ Chapter 12 â€” Adaptive Cards</div>
                <h2>Adaptive Cards â€” Universal UI!</h2>
                <p class="topic-subtitle">JSON-based cards jo har platform pe adapt ho jaaye!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ“‹</div>
                    <h3 class="section-title">Adaptive Cards Kya Hain?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Adaptive Cards</span> ek open card exchange format hai â€” JSON mein likho, har platform (Teams, Slack, Web) pe native UI ban jaaye!
                    </p>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¯ <strong>Adaptive Cards Benefits:</strong><br><br>
                        â€¢ <strong>Platform-agnostic</strong> â€” Ek baar design, everywhere use<br>
                        â€¢ <strong>Native rendering</strong> â€” Har platform apna style apply kare<br>
                        â€¢ <strong>Rich content</strong> â€” Text, images, inputs, actions sab support<br>
                        â€¢ <strong>JSON format</strong> â€” Easy to create aur modify<br><br>
                        
                        <em>Design karke dekho: <a href="https://adaptivecards.io/designer/" target="_blank">adaptivecards.io/designer</a></em>
                    </div>

                    <pre class="language-json line-numbers"><code>{
  "type": "AdaptiveCard",
  "body": [
    {
      "type": "TextBlock",
      "text": "Hello! ğŸ‘‹",
      "size": "Large",
      "weight": "Bolder"
    },
    {
      "type": "Input.Text",
      "id": "userName",
      "placeholder": "Enter your name"
    }
  ],
  "actions": [
    {
      "type": "Action.Submit",
      "title": "Submit"
    }
  ],
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "version": "1.5"
}</code></pre>

                    <div class="hinglish-note" style="background: rgba(255, 157, 67, 0.1); border-left-color: var(--accent-orange);">
                        âš ï¸ <strong>Channel Support Vary Hota Hai!</strong><br><br>
                        Har channel Adaptive Cards ko differently support karta hai:<br>
                        â€¢ <strong>Teams</strong> â€” Full support âœ…<br>
                        â€¢ <strong>Web Chat</strong> â€” Full support âœ…<br>
                        â€¢ <strong>Facebook</strong> â€” Limited (buttons may not work)<br><br>
                        
                        <em>Always test on target channels!</em>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Enterprise C# Code â€” Adaptive Card Renderer!</strong><br>
                        Channels jo Adaptive Cards support nahi karte, unke liye image render karo!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// Adaptive Card Renderer â€” Enterprise Channel SDK Code
// From: Intercom/Channels/Intercom.ChannelSDK - Card Image Rendering

/// &lt;summary&gt;
/// Adaptive Card ko IMAGE mein convert karo!
/// Jo channels Adaptive Cards support nahi karte (e.g., SMS, Email),
/// unke liye card ka screenshot render karke image bhej do.
/// &lt;/summary&gt;
public class AdaptiveCardRenderer : IAdaptiveCardRenderer
{
    private readonly string _channelId;

    public AdaptiveCardRenderer(string channelId)
    {
        _channelId = channelId;
    }

    /// &lt;summary&gt;
    /// Adaptive Card render karke Azure Blob Storage mein store karo.
    /// Image URL return hoga jo channel pe bhej sakte ho.
    /// &lt;/summary&gt;
    public Task&lt;string&gt; RenderAdaptiveCardToAttachmentStoreAsync(
        AdaptiveCard adaptiveCard, 
        string botID, 
        string botRegion, 
        IAttachmentStore attachmentStore, 
        int width, 
        bool disableBlobAnonymousAccess = true)
    {
        return AdaptiveCardImageRendererSingleton.RenderAdaptiveCardToAttachmentStoreAsync(
            adaptiveCard, 
            _channelId,     // Channel ke hisaab se styling
            botID, 
            botRegion, 
            attachmentStore, 
            width,          // Image width in pixels
            disableBlobAnonymousAccess);
    }

    /// &lt;summary&gt;
    /// Adaptive Card render karke raw attachment data return karo.
    /// Inline sending ke liye â€” storage mein save nahi karna.
    /// &lt;/summary&gt;
    public Task&lt;AttachmentData&gt; RenderAdaptiveCardToAttachmentDataAsync(
        AdaptiveCard adaptiveCard, 
        string botID, 
        string botRegion, 
        int width)
    {
        return AdaptiveCardImageRendererSingleton.RenderAdaptiveCardToAttachmentDataAsync(
            adaptiveCard, 
            _channelId, 
            botID, 
            botRegion, 
            width);
    }
}

// Usage in channel: 
// var renderer = new AdaptiveCardRenderer("whatsapp");
// var imageUrl = await renderer.RenderAdaptiveCardToAttachmentStoreAsync(
//     adaptiveCard, botId, "westus", attachmentStore, 400);
// // Now send imageUrl to WhatsApp instead of JSON card!</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 13: Proactive Messaging ==================== -->
        <section class="topic-section" id="proactive">
            <header class="topic-header">
                <div class="topic-badge">ğŸ“¢ Chapter 13 â€” Proactive Messaging</div>
                <h2>Proactive Messages â€” Bot Pehle Bole!</h2>
                <p class="topic-subtitle">User ke bina maange notifications bhejo â€” alerts, reminders, updates!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ“¢</div>
                    <h3 class="section-title">Proactive vs Reactive Messages</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Normally bot <strong>reactive</strong> hota hai â€” user message bheje tab reply kare. <span class="highlight">Proactive messaging</span> mein bot khud initiate karta hai conversation!
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ“Š Reactive vs Proactive</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">REACTIVE VS PROACTIVE MESSAGING</div>
                            <div class="mermaid">
flowchart LR
    subgraph Reactive["ğŸ”„ REACTIVE"]
        U1["ğŸ‘¤ User: 'What's the weather?'"]
        B1["ğŸ¤– Bot: 'Sunny, 25Â°C'"]
                        U1 --> B1
                    end
                    
                    subgraph Proactive["ğŸ“¢ PROACTIVE"]
                        T["â° Trigger<br/>(Timer, Event, API)"]
                        B2["ğŸ¤– Bot: 'Reminder: Meeting in 10 mins!'"]
                        U2["ğŸ‘¤ User receives notification"]
                        T --> B2 --> U2
                    end
                    
                    style U1 fill:#3a86ff,color:#fff
                    style B1 fill:#00ff88,color:#000
                    style T fill:#ff9f43,color:#fff
                    style B2 fill:#00ff88,color:#000
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“š <strong>Proactive Messaging Use Cases:</strong><br><br>
                        â€¢ <strong>Price Alerts</strong> â€” "Product price dropped by 20%!"<br>
                        â€¢ <strong>Meeting Reminders</strong> â€” "Meeting starts in 10 minutes"<br>
                        â€¢ <strong>Task Completion</strong> â€” "Your report is ready to download"<br>
                        â€¢ <strong>Welcome Messages</strong> â€” App install ke baad welcome<br><br>
                        
                        <em>Note: Kuch channels restrict karte hain â€” user ne pehle bot se baat ki ho tabhi proactive message bhej sakte ho!</em>
                    </div>

                    <div class="hinglish-note" style="background: rgba(255, 107, 107, 0.1); border-left-color: var(--accent-red);">
                        âš ï¸ <strong>Conversation Reference Required!</strong><br><br>
                        Proactive message bhejne ke liye <strong>ConversationReference</strong> save karna padta hai â€” ye tab milta hai jab user pehli baar bot se interact kare.<br><br>
                        
                        <strong>Process:</strong><br>
                        1. User bot se baat kare â†’ ConversationReference capture karo<br>
                        2. Database mein store karo<br>
                        3. Later: ContinueConversationAsync use karke message bhejo
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” 16.proactive-messages sample se!</strong>
                    </div>

                    <pre class="language-python line-numbers"><code># Proactive Bot â€” from 16.proactive-messages sample
from typing import Dict
from botbuilder.core import ActivityHandler, TurnContext
from botbuilder.schema import ConversationReference, Activity

class ProactiveBot(ActivityHandler):
    """
    Proactive Messaging â€” Bot pehle message kare bina user ke!
    Reminders, notifications, alerts ke liye use karo.
    """
    
    def __init__(self, conversation_references: Dict[str, ConversationReference]):
        # Dictionary to store conversation references
        self.conversation_references = conversation_references
    
    async def on_conversation_update_activity(self, turn_context: TurnContext):
        # Jab bhi conversation update ho, reference save karo
        self._add_conversation_reference(turn_context.activity)
        return await super().on_conversation_update_activity(turn_context)
    
    async def on_message_activity(self, turn_context: TurnContext):
        # Har message pe reference save karo (update latest info)
        self._add_conversation_reference(turn_context.activity)
        
        return await turn_context.send_activity(
            f"You sent: {turn_context.activity.text}\n\n"
            f"Navigate to http://localhost:3978/api/notify to proactively message!"
        )
    
    def _add_conversation_reference(self, activity: Activity):
        """
        ConversationReference capture aur store karo.
        Ye reference baad mein proactive message bhejne ke liye use hoga!
        """
        conversation_reference = TurnContext.get_conversation_reference(activity)
        # User ID ke saath store karo
        self.conversation_references[conversation_reference.user.id] = conversation_reference


# app.py mein â€” Proactive message bhejne ka endpoint
# @app.route("/api/notify", methods=["POST"])
async def notify_all_users(adapter, conversation_references):
    """
    Sabhi stored users ko message bhejo!
    Ye API endpoint se trigger hota hai.
    """
    for conversation_reference in conversation_references.values():
        await adapter.continue_conversation(
            conversation_reference,
            lambda turn_context: turn_context.send_activity("Proactive hello! ğŸ‰"),
            app_id
        )</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Enterprise C# Code â€” PostBox Messaging System!</strong><br>
                        Real Azure Bot Service mein distributed proactive messaging kaise handle hoti hai!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// PostBox â€” Enterprise Proactive Message Delivery (From Intercom Codebase)
// Distributed message delivery for scaled-out bot scenarios

public class PostBox : IPostBox, IPostBoxInternal
{
    private readonly CancellationTokenSource _ctSource = new CancellationTokenSource();
    private readonly IPostBoxListener _listener;
    private readonly IPostBoxClient _redisClient;     // Redis for fast delivery
    private readonly IPostBoxClient _httpPostBoxClient; // HTTP fallback
    private readonly IInstanceTable _instanceTable;    // Bot instance tracking

    public string InstanceId { get; }
    public string SiteUrl { get; }

    public static readonly string MachineName = Environment.GetEnvironmentVariable("COMPUTERNAME");
    public static readonly string SiteName = Environment.GetEnvironmentVariable("WEBSITE_SITE_NAME");
    public static readonly string AffinityId = Environment.GetEnvironmentVariable("WEBSITE_INSTANCE_ID");

    /// &lt;summary&gt;
    /// Proactive message post karo kisi bhi instance pe!
    /// First Redis try karo (fast), phir HTTP fallback.
    /// &lt;/summary&gt;
    public async Task PostAsync(string instanceId, string contentType, string content, 
                                 string activityId, CancellationToken token = default)
    {
        // Local delivery â€” same instance pe hai?
        if (instanceId == InstanceId && await Dials.DirectLine.LoopbackForLocalCrates.GetValueAsync())
        {
            var delivered = await DispatchAsync(contentType, content, null);
            AppInsights.TrackTraceEx("PostBox.Dispatch", "Source", "Direct", "Delivered", delivered);
        }
        else
        {
            // Remote instance pe deliver karna hai
            var instance = await _instanceTable.GetInstanceAsync(instanceId, cancellationToken: token);
            if (instance == null)
            {
                AppInsights.TrackTraceEx("Instance not found", "InstanceId", instanceId);
                return;  // Instance no longer active
            }
            await PostAsync(instance, contentType, content, activityId, token);
        }
    }

    /// &lt;summary&gt;
    /// Smart delivery â€” Redis first, HTTP fallback
    /// Redis fast hai lekin unreliable, HTTP slow but guaranteed.
    /// &lt;/summary&gt;
    private async Task&lt;bool&gt; PostAsync(InstanceDocument instanceDocument, string contentType, 
                                        string content, string activityId, CancellationToken token)
    {
        var messageId = IdFactory.CreateId();
        var cts = CancellationTokenSource.CreateLinkedTokenSource(token);

        // Redis try karo with 1 second timeout
        var redisTask = _redisClient.SendAsync(instanceDocument, contentType, content, messageId, activityId, token);
        var completedTask = await Task.WhenAny(redisTask, Task.Delay(TimeSpan.FromSeconds(1), token));

        if (completedTask == redisTask)
        {
            var delivered = await redisTask;
            if (delivered) return true;  // Redis delivered! Done!
        }

        // Redis didn't work â€” HTTP fallback
        AppInsights.TrackTrace($"Redis didn't deliver. Starting Http task");
        return await _httpPostBoxClient.SendAsync(instanceDocument, contentType, content, messageId, activityId, token);
    }

    /// &lt;summary&gt;
    /// Conversation evict karo â€” stale conversation cleanup
    /// &lt;/summary&gt;
    public async Task EvictAsync(string instanceId, string conversationId)
    {
        var instance = await _instanceTable.GetInstanceAsync(instanceId, CancellationToken.None);
        if (instance == null) return;

        AppInsights.TrackEventEx("POSTBOX: Posting eviction", 
            "Instance ID", InstanceId, "ConversationId", conversationId);

        await PostAsync(instance, "evict",
            JsonConvert.SerializeObject(new EvictionNotice()
            {
                InstanceId = instance.InstanceId,
                ConversationId = conversationId
            }), null, CancellationToken.None);
    }
}</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Cognitive Services Token Generator â€” Speech Integration!</strong><br>
                        Web Chat aur Emulator mein Speech kaise enable hota hai!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// Cognitive Services Token Generator â€” Enterprise Speech Integration
// From: Intercom/Utilities/SpeechServices - Speech-to-Text Token Management

/// &lt;summary&gt;
/// Speech Recognition tokens generate karo for Emulator/WebChat.
/// Ye tokens Azure Cognitive Services Speech API ke liye hain.
/// &lt;/summary&gt;
public class CognitiveServicesTokenGenerator : ICognitiveServicesTokenGenerator
{
    private static readonly HttpClient _httpClient = new HttpClient();
    
    // Cognitive Services tokens sirf 10 minutes valid hote hain!
    private static TimeSpan _cognitiveServiceTokenMaxLife = TimeSpan.FromMinutes(10);

    /// &lt;summary&gt;
    /// Speech token generate karo â€” Emulator microphone use kar sake!
    /// &lt;/summary&gt;
    public async Task&lt;SpeechTokenInfo&gt; GetTokenAsync()
    {
        if (!CognitiveServicePerCloud.Instance.GetSettings().IsSpeechServiceEnabled)
            throw new Exception("Cognitive Speech Services not enabled in this region.");

        var attempt = 0;
        var maxRetries = await Dials.Channels.GetCognitiveServiceTokenMaxRetries.GetValueAsync();

        while (attempt++ &lt;= maxRetries)
        {
            try
            {
                using (var request = new HttpRequestMessage(HttpMethod.Post, 
                    CognitiveServicePerCloud.Instance.GetSettings().EndPoint))
                {
                    // Subscription key header â€” Azure portal se
                    request.Headers.Add("Ocp-Apim-Subscription-Key", GetSubscriptionKey());

                    using (HttpResponseMessage response = await _httpClient.SendAsync(request))
                    {
                        response.EnsureSuccessStatusCode();

                        return new SpeechTokenInfo
                        {
                            AccessToken = await response.Content.ReadAsStringAsync(),
                            Region = CognitiveServicePerCloud.Instance.GetSettings().RegionName,
                            Expiry = DateTimeOffset.UtcNow.Add(_cognitiveServiceTokenMaxLife).ToUnixTimeMilliseconds(),
                            TokenLife = _cognitiveServiceTokenMaxLife.TotalMilliseconds
                        };
                    }
                }
            }
            catch (Exception ex)
            {
                AppInsights.TrackException(ex, "Getting Speech Service Token Failed");
                if (attempt &gt;= maxRetries) throw;
            }

            // Exponential backoff
            await Task.Delay(TimeSpan.FromSeconds(attempt));
        }

        throw new Exception("Speech Services did not return a token");
    }

    private static string GetSubscriptionKey()
    {
        string key = IntercomEnvironment.Current.SecretGlobal(BindGlobal.accounts_emulatorSpeech);
        if (string.IsNullOrEmpty(key))
            throw new Exception("Subscription Key Not Found!");
        return key;
    }
}</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 14: Natural Language ==================== -->
        <section class="topic-section" id="nlu">
            <header class="topic-header">
                <div class="topic-badge">ğŸ§  Chapter 14 â€” Natural Language Understanding</div>
                <h2>NLU â€” Bot Ko Smart Banao!</h2>
                <p class="topic-subtitle">LUIS replaced by Azure AI Language â€” Conversational Language Understanding (CLU)!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ§ </div>
                    <h3 class="section-title">Intent & Entity Recognition</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Natural Language Understanding (NLU)</span> se bot user ki natural language samajh paata hai â€” keywords match nahi karna padta!
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ¯ Intent & Entity Example</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">NLU â€” INTENT & ENTITY EXTRACTION</div>
                            <div class="mermaid">
flowchart TB
    Input["ğŸ‘¤ User: 'Book a flight to Delhi tomorrow'"]
    
    NLU["ğŸ§  CLU Processing"]
    
    Intent["ğŸ¯ INTENT<br/>BookFlight"]
    Entity1["ğŸ“ ENTITY: Destination<br/>Delhi"]
    Entity2["ğŸ“… ENTITY: Date<br/>Tomorrow"]
    
    Input --> NLU
    NLU --> Intent
    NLU --> Entity1
    NLU --> Entity2
    
    style Input fill:#3a86ff,color:#fff
    style NLU fill:#8338ec,color:#fff
    style Intent fill:#00ff88,color:#000
    style Entity1 fill:#ff9f43,color:#fff
    style Entity2 fill:#ffd93d,color:#000
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(255, 157, 67, 0.1); border-left-color: var(--accent-orange);">
                        âš ï¸ <strong>LUIS Retired â€” Use CLU!</strong><br><br>
                        <strong>Language Understanding (LUIS)</strong> October 1, 2025 ko retire ho gaya hai!<br><br>
                        
                        <strong>Replacement:</strong> <strong>Conversational Language Understanding (CLU)</strong><br>
                        â†’ Part of Azure AI Language service<br>
                        â†’ Same capabilities, better integration<br><br>
                        
                        <strong>QnA Maker</strong> bhi retired â€” use <strong>Custom Question Answering</strong> (Azure AI Language feature)
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Enterprise C# Code â€” LUIS API Client (Legacy but Educational)!</strong><br>
                        Real Azure Bot Service LUIS integration code â€” shows how NLU APIs work internally!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// LUIS Cognitive Service API Client â€” Enterprise Production Code
// From: Intercom/Utilities/Intercom.Luis - Real ABS LUIS Infrastructure

public class LuisCognitiveServiceApiClient : LuisApiBase, ILuisCognitiveServiceApiClient
{
    // Training status types jo polling mein check hote hain
    private static readonly ISet&lt;LuisTrainResponse.TrainStatus&gt; TerminalTrainingStatuses = 
        new HashSet&lt;LuisTrainResponse.TrainStatus&gt;
    {
        LuisTrainResponse.TrainStatus.Fail,
        LuisTrainResponse.TrainStatus.Success,
        LuisTrainResponse.TrainStatus.UpToDate  // Already trained
    };

    private readonly TimeSpan _modelTrainPollInterval = TimeSpan.FromSeconds(1);
    private const int ModelTrainPollRetryCount = 50;

    private const string AppsPath = "/apps";
    private const string ImportPath = AppsPath + "/import";

    /// &lt;summary&gt;
    /// Bot ko LUIS App access authorize karo.
    /// Runtime permissions set karo â€” bot ye app use kar sake.
    /// &lt;/summary&gt;
    public async Task AuthorizeBotToApp(string progKey, string botAppId, string luisAppId)
    {
        var request = new AuthorizeBotRequest { AuthId = botAppId };
        await Post(
            new LuisApiCigEndpoint(_luisCigApiHostName, progKey, privateEndpoint: true), 
            $"{AppsPath}/{luisAppId}/runtimepermissions/bot", 
            request).ConfigureAwait(false);
    }

    /// &lt;summary&gt;
    /// LUIS App import karo from JSON definition.
    /// New app create hoga with intents, entities, utterances.
    /// &lt;/summary&gt;
    public async Task&lt;string&gt; ImportApp(string progKey, string appName, string appJson)
    {
        var response = await PostJson(
            new LuisApiCigEndpoint(_luisCigApiHostName, progKey), 
            ImportPath, 
            appJson, 
            new Dictionary&lt;string, string&gt; { ["appName"] = appName }
        ).ConfigureAwait(false);
        
        return response == null ? null : JsonConvert.DeserializeObject&lt;string&gt;(response);
    }

    /// &lt;summary&gt;
    /// LUIS model train karo!
    /// Training asynchronous hai â€” poll karo status check karne ke liye.
    /// &lt;/summary&gt;
    public async Task&lt;LuisTrainResponse.TrainStatus&gt; Train(string appId, string key, string version)
    {
        // Training trigger karo
        string postTrainResp = await Post(
            new LuisApiCigEndpoint(_luisCigApiHostName, key), 
            $"/apps/{appId}/versions/{version}/train", 
            string.Empty).ConfigureAwait(false);
        
        LuisAppTrainingStatus status = JsonConvert.DeserializeObject&lt;LuisAppTrainingStatus&gt;(postTrainResp);
        
        if (status.Status == LuisTrainResponse.TrainStatus.UpToDate)
            return LuisTrainResponse.TrainStatus.UpToDate;  // Already trained!

        // Poll for completion â€” training takes time
        ICollection&lt;LuisTrainResponse&gt; trainingStatus = null;
        for (int retryAttempts = 0; retryAttempts &lt; ModelTrainPollRetryCount; retryAttempts++)
        {
            trainingStatus = (await GetTrainingStatus(appId, key, version)).ToArray();
            
            if (AllModelsTrained(trainingStatus))
            {
                return trainingStatus.All(p =&gt; p.Details.Status != LuisTrainResponse.TrainStatus.Fail) 
                    ? LuisTrainResponse.TrainStatus.Success 
                    : LuisTrainResponse.TrainStatus.Fail;
            }

            await Task.Delay(_modelTrainPollInterval).ConfigureAwait(false);
        }

        return LuisTrainResponse.TrainStatus.Fail;
    }

    /// &lt;summary&gt;
    /// Trained model publish karo â€” production endpoint pe deploy
    /// &lt;/summary&gt;
    public async Task Publish(string appId, string key, string version)
    {
        await Post(
            new LuisApiCigEndpoint(_luisCigApiHostName, key), 
            $"/apps/{appId}/publish", 
            new { versionId = version, isStaging = false }  // Production slot
        ).ConfigureAwait(false);
    }
}</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 15: Skills ==================== -->
        <section class="topic-section" id="skills">
            <header class="topic-header">
                <div class="topic-badge">ğŸ”§ Chapter 15 â€” Skills</div>
                <h2>Bot Skills â€” Reusable Bot Capabilities!</h2>
                <p class="topic-subtitle">Ek bot doosre bot ko call kar sakta hai â€” modular design!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ”§</div>
                    <h3 class="section-title">Skills Kya Hain?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Skill</span> ek reusable bot hai jo doosre bots (skill consumers) access kar sakte hain. Jaise microservices architecture mein services ek dusre ko call karti hain!
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ”— Skill Architecture</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">SKILL CONSUMER & SKILL BOT</div>
                            <div class="mermaid">
flowchart TB
    User["ğŸ‘¤ User"]
    Consumer["ğŸ¤– ROOT BOT<br/>(Skill Consumer)"]
    
    subgraph Skills["SKILL BOTS"]
                        S1["ğŸ“… Calendar Skill"]
                        S2["ğŸ“§ Email Skill"]
                        S3["ğŸ“ To-Do Skill"]
                    end
                    
                    User <--> Consumer
                    Consumer <--> S1
                    Consumer <--> S2
                    Consumer <--> S3
                    
                    style Consumer fill:#0078d4,color:#fff
                    style S1 fill:#00ff88,color:#000
                    style S2 fill:#ff9f43,color:#fff
                    style S3 fill:#8338ec,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        ğŸ’¡ <strong>Skill Benefits:</strong><br><br>
                        â€¢ <strong>Reusability</strong> â€” Ek skill multiple bots use kar sakte hain<br>
                        â€¢ <strong>Modularity</strong> â€” Large bot ko smaller skills mein break karo<br>
                        â€¢ <strong>Team Collaboration</strong> â€” Different teams different skills develop karein<br>
                        â€¢ <strong>Independent Deployment</strong> â€” Skills separately deploy ho sakte hain
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” 80.skills-simple-bot-to-bot sample se!</strong>
                    </div>

                    <pre class="language-python line-numbers"><code># SKILL BOT â€” Echo Skill (from echo-skill-bot sample)
from botbuilder.core import ActivityHandler, MessageFactory, TurnContext
from botbuilder.schema import Activity, ActivityTypes, EndOfConversationCodes

class EchoSkillBot(ActivityHandler):
    """
    Ye ek SKILL bot hai â€” doosra bot (Root Bot) isko call karega!
    Skill apna kaam karke EndOfConversation bhejega.
    """
    
    async def on_message_activity(self, turn_context: TurnContext):
        if "end" in turn_context.activity.text.lower():
            # Skill khatam â€” EndOfConversation bhejo!
            await turn_context.send_activity(MessageFactory.text("Ending skill..."))
            
            end_of_conversation = Activity(type=ActivityTypes.end_of_conversation)
            end_of_conversation.code = EndOfConversationCodes.completed_successfully
            await turn_context.send_activity(end_of_conversation)
        else:
            # Normal echo response
            await turn_context.send_activity(
                MessageFactory.text(f"Skill Echo: {turn_context.activity.text}")
            )
            await turn_context.send_activity(
                MessageFactory.text('Say "end" to return to root bot')
            )


# ROOT BOT â€” Skill Consumer (from simple-root-bot sample)
from botbuilder.core.skills import BotFrameworkSkill
from botbuilder.integration.aiohttp.skills import SkillHttpClient

class RootBot(ActivityHandler):
    """
    ROOT BOT â€” Ye Skill Consumer hai.
    User ka message skill ko forward karta hai!
    """
    
    def __init__(self, conversation_state, skills_config, skill_client):
        self._skill_client = skill_client
        self._skills_config = skills_config
        self._conversation_state = conversation_state
        self._active_skill_property = conversation_state.create_property("activeSkill")
    
    async def on_message_activity(self, turn_context: TurnContext):
        if "skill" in turn_context.activity.text.lower():
            # Skill activate karo!
            await turn_context.send_activity("Connecting to skill...")
            
            skill = self._skills_config.SKILLS["EchoSkillBot"]
            await self._active_skill_property.set(turn_context, skill)
            
            # Skill ko message forward karo
            await self._skill_client.post_activity_to_skill(
                self._bot_id, skill, skill_host_endpoint, turn_context.activity
            )
        else:
            await turn_context.send_activity('Say "skill" to connect to Echo Skill')</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 16: Testing ==================== -->
        <section class="topic-section" id="testing">
            <header class="topic-header">
                <div class="topic-badge">ğŸ§ª Chapter 16 â€” Testing</div>
                <h2>Bot Testing â€” Emulator & More!</h2>
                <p class="topic-subtitle">Local testing se production testing tak â€” sab cover karo!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ§ª</div>
                    <h3 class="section-title">Bot Framework Emulator</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Bot Framework Emulator</span> ek desktop application hai jo locally bots test karne ke liye use hoti hai. Real channel ki zaroorat nahi!
                    </p>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h5>ğŸ’» Local Testing</h5>
                            <p>Bot ko localhost pe run karo, Emulator se connect karo, test karo!</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ” Inspect Messages</h5>
                            <p>JSON payload dekho â€” activities ka detailed view</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ› Debug</h5>
                            <p>VS Code/Visual Studio mein breakpoints lagao</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ“¡ ngrok Integration</h5>
                            <p>Tunnel use karke remote services se connect karo</p>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(255, 107, 107, 0.1); border-left-color: var(--accent-red);">
                        âš ï¸ <strong>Emulator Archived!</strong><br><br>
                        Bot Framework Emulator bhi archive ho gaya hai (Dec 2025).<br>
                        Existing version use kar sakte ho, lekin new features nahi aayenge.<br><br>
                        
                        <strong>Alternative:</strong> Web Chat test page, Teams Developer Portal, Direct testing on channels
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 17: Deployment ==================== -->
        <section class="topic-section" id="deployment">
            <header class="topic-header">
                <div class="topic-badge">ğŸš€ Chapter 17 â€” Deployment</div>
                <h2>Azure Deployment â€” Bot Ko Live Karo!</h2>
                <p class="topic-subtitle">Local se Azure tak â€” bot ko duniya ke saamne lao!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸš€</div>
                    <h3 class="section-title">Deployment Steps</h3>
                </div>
                <div class="section-content">
                    <div class="visual-box">
                        <h4>ğŸš€ Deployment Flow</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">BOT DEPLOYMENT TO AZURE</div>
                            <div class="mermaid">
flowchart TB
    Dev["ğŸ’» LOCAL DEVELOPMENT<br/>VS Code / Visual Studio"]
    
    subgraph Azure["â˜ï¸ AZURE RESOURCES"]
                        AppService["ğŸŒ App Service<br/>(Hosts bot code)"]
                        BotService["ğŸ¤– Azure Bot Service<br/>(Bot registration)"]
                        AI["ğŸ§  Azure AI Services<br/>(Optional: CLU, etc.)"]
                    end
                    
                    Dev -->|"Deploy"| AppService
                    AppService <--> BotService
                    BotService <--> AI
                    
                    Channels["ğŸŒ CHANNELS<br/>Teams, Slack, Web Chat"]
                    
                    BotService <--> Channels
                    
                    style Dev fill:#3a86ff,color:#fff
                    style AppService fill:#00ff88,color:#000
                    style BotService fill:#0078d4,color:#fff
                    style Channels fill:#ff9f43,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        ğŸ“‹ <strong>Deployment Checklist:</strong><br><br>
                        1. âœ… Azure subscription create karo<br>
                        2. âœ… App Service plan create karo<br>
                        3. âœ… Azure Bot Service resource create karo<br>
                        4. âœ… App ID aur Password configure karo<br>
                        5. âœ… Bot code deploy karo (VS Code Azure extension ya CLI)<br>
                        6. âœ… Channels configure karo (Teams, etc.)<br>
                        7. âœ… Test karo live environment mein!
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 18: User Authentication ==================== -->
        <section class="topic-section" id="authentication">
            <header class="topic-header">
                <div class="topic-badge">ğŸ” Chapter 18 â€” Authentication</div>
                <h2>User Authentication â€” OAuth Integration!</h2>
                <p class="topic-subtitle">User ko login karwao, secure resources access karo!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ”</div>
                    <h3 class="section-title">Bots Mein Authentication Kyun?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Kabhi-kabhi bot ko user ki taraf se <span class="highlight">secured resources access</span> karne padte hain â€” jaise email check karna, calendar dekhna, orders place karna. Iske liye user authentication zaroori hai!
                    </p>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“š <strong>OAuth Flow â€” Simple Explanation:</strong><br><br>
                        1. User bot se kuch request kare jo login chahiye (e.g., "Check my emails")<br>
                        2. Bot <strong>OAuthCard</strong> send kare with "Sign In" button<br>
                        3. User button click kare â†’ External service ki login page khule<br>
                        4. User login kare â†’ Token generate ho<br>
                        5. Token <strong>Bot Framework Token Service</strong> mein securely store ho<br>
                        6. Bot ab user ki taraf se API calls kar sake!
                    </div>

                    <div class="visual-box">
                        <h4>ğŸ”„ OAuth Authentication Flow</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">USER AUTHENTICATION IN BOT</div>
                            <div class="mermaid">
flowchart TB
    U["ğŸ‘¤ User: 'Check my emails'"]
    B["ğŸ¤– Bot asks for token"]
    TS["ğŸ”‘ Token Service<br/>'No token found'"]
    Card["ğŸƒ Bot sends OAuthCard<br/>'Please sign in'"]
    Login["ğŸ” User signs in<br/>(Microsoft, Google, etc.)"]
    Token["âœ… Token stored securely"]
    API["ğŸ“§ Bot calls API<br/>with user's token"]
    
    U --> B
    B --> TS
    TS --> Card
    Card --> Login
    Login --> Token
    Token --> API
    
    style U fill:#3a86ff,color:#fff
    style Login fill:#ff9f43,color:#fff
    style Token fill:#00ff88,color:#000
    style API fill:#8338ec,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h5>ğŸ”‘ OAuth Connection</h5>
                            <p>Azure Portal mein configure karo â€” Identity Provider, Client ID, Secret, Scopes</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸƒ OAuthCard</h5>
                            <p>User ko sign-in button dikhata hai â€” click pe login page khulti hai</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ” Token Service</h5>
                            <p>Bot Framework Token Service tokens securely store aur manage karta hai</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ”¢ Magic Code</h5>
                            <p>6-digit code for verification â€” ensures same user signed in</p>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(255, 157, 67, 0.1); border-left-color: var(--accent-orange);">
                        âš ï¸ <strong>Security Tip:</strong><br><br>
                        Sign-in URL <strong>kabhi share mat karo!</strong> Ye specific conversation ke liye hoti hai.<br>
                        Kuch channels (Teams, Web Chat) automatically verify karte hain, baaki channels mein <strong>6-digit magic code</strong> enter karna padta hai confirmation ke liye.
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” 18.bot-authentication sample se!</strong>
                    </div>

                    <pre class="language-python line-numbers"><code># Authentication Bot â€” from 18.bot-authentication sample
from botbuilder.core import ConversationState, UserState, TurnContext
from botbuilder.dialogs import Dialog
from helpers.dialog_helper import DialogHelper

class AuthBot(DialogBot):
    """
    Authentication Bot â€” User ko login karwao, secure resources access karo!
    OAuth flow handle karta hai ye bot.
    """
    
    def __init__(self, conversation_state: ConversationState, user_state: UserState, dialog: Dialog):
        super().__init__(conversation_state, user_state, dialog)
    
    async def on_members_added_activity(self, members_added, turn_context: TurnContext):
        for member in members_added:
            if member.id != turn_context.activity.recipient.id:
                await turn_context.send_activity(
                    "Welcome to AuthenticationBot! Type anything to login. "
                    "Type 'logout' to sign-out."
                )
    
    async def on_token_response_event(self, turn_context: TurnContext):
        """
        âš¡ TOKEN RESPONSE EVENT â€” Ye tab fire hota hai jab:
        1. User ne login kiya
        2. Token service ne token return kiya
        
        Is event mein dialog continue karo jo token use karega!
        """
        await DialogHelper.run_dialog(
            self.dialog,
            turn_context,
            self.conversation_state.create_property("DialogState")
        )


# Main Dialog mein OAuth Prompt use karo
from botbuilder.dialogs.prompts import OAuthPrompt, OAuthPromptSettings

class MainDialog(ComponentDialog):
    def __init__(self, connection_name: str):
        super().__init__(MainDialog.__name__)
        
        # OAuth Prompt add karo
        self.add_dialog(OAuthPrompt(
            OAuthPrompt.__name__,
            OAuthPromptSettings(
                connection_name=connection_name,  # Azure Portal mein configure kiya hua
                text="Please sign in",
                title="Sign In",
                timeout=300000  # 5 minutes
            )
        ))
    
    async def prompt_step(self, step_context):
        """User ko login karwao"""
        return await step_context.begin_dialog(OAuthPrompt.__name__)
    
    async def login_step(self, step_context):
        """Token mil gaya! Ab use karo"""
        token_response = step_context.result
        
        if token_response:
            await step_context.context.send_activity(f"You are now logged in! âœ…")
            # Token use karke API call karo (e.g., Microsoft Graph)
            # token_response.token mein actual token hai
        else:
            await step_context.context.send_activity("Login failed. Please try again.")
        
        return await step_context.end_dialog()</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Enterprise C# Code â€” Auth Helper & Token Validation!</strong><br>
                        Ye code Azure Bot Service Intercom production infrastructure se hai!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// Auth Helper â€” First Party App Validation (Enterprise Production Code)
// From: Intercom/Utilities - Real ABS Authentication Infrastructure

public static class AuthHelper
{
    /// &lt;summary&gt;
    /// Check karo ki incoming token First Party App se hai ya nahi.
    /// Bot Connector se aane wale requests verify karo!
    /// &lt;/summary&gt;
    public static bool IsFirstPartyApp(string token)
    {
        if (string.IsNullOrEmpty(token))
            throw new ArgumentNullException(nameof(token));

        // JWT token se claims extract karo
        var principal = TokenExchanger.GetPrincipalForToken(token);
        return principal != null && IsFirstPartyApp(principal);
    }

    /// &lt;summary&gt;
    /// ClaimsPrincipal se App ID check karo
    /// First Party = Microsoft's own Bot Framework infrastructure
    /// &lt;/summary&gt;
    public static bool IsFirstPartyApp(ClaimsPrincipal principal)
    {
        if (principal == null)
            throw new ArgumentNullException(nameof(principal));

        // JWT claims se App ID nikalo
        var appId = principal.GetAppId();
        
        // Environment-specific settings se compare karo
        var firstPartyAppId = SecurityPerEnvironment.Instance.GetSettings().FirstPartyAppClientId;
        
        return string.Equals(appId, firstPartyAppId, StringComparison.OrdinalIgnoreCase);
    }
}</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ¢ <strong>Token Maker â€” Secure Key Generation!</strong><br>
                        Azure Bot Service mein secure tokens kaise generate hote hain!
                    </div>

                    <pre class="language-csharp line-numbers"><code>// Token Maker â€” Cryptographic Key Generation (Enterprise Code)
// From: Intercom/Utilities/TokenMaker - Production Security Infrastructure

public class TokenMaker
{
    private static RNGCryptoServiceProvider _crypto = new RNGCryptoServiceProvider();
    private readonly IEncoder _encoder;
    private AzureCloud _cloudName;
    const string AzureFunctionsSignature = "AZBS";  // Azure Bot Service signature

    /// &lt;summary&gt;
    /// Azure Common Annotated Key generate karo
    /// New compliant format with metadata embedded
    /// &lt;/summary&gt;
    private string GenerateAzureCommonAnnotatedKey()
    {
        string tenantId = GetTenantId();
        
        // Microsoft Security Utilities library use karke secure key
        return AzureIdentifiableSecrets.GenerateAzureCommonAnnotatedKey(
            signature: AzureFunctionsSignature,
            customerManagedKey: true,
            cloud: _cloudName,
            region: _regionName.ToString(),
            tenantGuid: Guid.Parse(tenantId),
            (byte)KeyKind.FunctionScope
        );
    }

    /// &lt;summary&gt;
    /// App Secret generate karo â€” internally verifiable
    /// &lt;/summary&gt;
    public string GenerateSecret(string siteId, bool useNewFormat)
    {
        byte[] appBytes = _encoder.Decode(siteId);
        
        if (useNewFormat)
        {
            var entropy = GenerateAzureCommonAnnotatedKey();
            return _encoder.Join(appBytes, _encoder.Decode(entropy));
        }
        else
        {
            byte[] entropyBytes = GenerateRandomBytes(32);  // Legacy format
            return _encoder.Join(appBytes, entropyBytes);
        }
    }
}</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 19: Microsoft Teams Bots ==================== -->
        <section class="topic-section" id="teams">
            <header class="topic-header">
                <div class="topic-badge">ğŸ’¬ Chapter 19 â€” Microsoft Teams</div>
                <h2>Teams Bots â€” Enterprise Favorite!</h2>
                <p class="topic-subtitle">Teams ke liye special activity handlers aur features!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ’¬</div>
                    <h3 class="section-title">Teams Activity Handler</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Teams Activity Handler</span> normal ActivityHandler se derive hota hai, but Teams-specific activities handle karta hai â€” channel creation, team events, meetings, etc.
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ“‹ Teams-Specific Events</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">TEAMS ACTIVITY HANDLER â€” SPECIAL EVENTS</div>
                            <div class="mermaid">
flowchart TB
    TAH["TeamsActivityHandler"]
    
    subgraph Channel["ğŸ“¢ CHANNEL EVENTS"]
                        C1["OnTeamsChannelCreatedAsync"]
                        C2["OnTeamsChannelDeletedAsync"]
                        C3["OnTeamsChannelRenamedAsync"]
                    end
                    
                    subgraph Team["ğŸ‘¥ TEAM EVENTS"]
                        T1["OnTeamsMembersAddedAsync"]
                        T2["OnTeamsMembersRemovedAsync"]
                        T3["OnTeamsTeamRenamedAsync"]
                    end
                    
                    subgraph Meeting["ğŸ“… MEETING EVENTS"]
                        M1["OnTeamsMeetingStartAsync"]
                        M2["OnTeamsMeetingEndAsync"]
                    end
                    
                    TAH --> Channel
                    TAH --> Team
                    TAH --> Meeting
                    
                    style TAH fill:#0078d4,color:#fff
                    style C1 fill:#00ff88,color:#000
                    style T1 fill:#ff9f43,color:#fff
                    style M1 fill:#8338ec,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note">
                        ğŸ’¡ <strong>Teams-Specific Features:</strong><br><br>
                        â€¢ <strong>Messaging Extensions</strong> â€” Search aur actions directly Teams mein<br>
                        â€¢ <strong>Task Modules</strong> â€” Modal dialogs for input<br>
                        â€¢ <strong>Adaptive Cards</strong> â€” Rich interactive cards<br>
                        â€¢ <strong>Meeting Bots</strong> â€” Meeting start/end events handle karo<br>
                        â€¢ <strong>File Consent</strong> â€” File upload/download permissions<br><br>
                        
                        <em>Teams bots ke liye <code>TeamsActivityHandler</code> inherit karo instead of <code>ActivityHandler</code>!</em>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 20: Suggested Actions ==================== -->
        <section class="topic-section" id="suggested-actions">
            <header class="topic-header">
                <div class="topic-badge">ğŸ”˜ Chapter 20 â€” Suggested Actions</div>
                <h2>Suggested Actions â€” Quick Reply Buttons!</h2>
                <p class="topic-subtitle">User ko options do â€” click karo aur reply ho jaye!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ”˜</div>
                    <h3 class="section-title">Suggested Actions Kya Hain?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Suggested Actions</span> buttons hain jo user ko quick reply options dete hain. User click kare aur woh text message ban ke chala jaye!
                    </p>

                    <div class="visual-box">
                        <h4>ğŸ”˜ Suggested Actions vs Cards</h4>
                        <div class="feature-grid">
                            <div class="feature-card">
                                <h5>ğŸ”˜ Suggested Actions</h5>
                                <p>â€¢ Click ke baad disappear ho jaate hain<br>â€¢ Inline buttons jaisa dikhta hai<br>â€¢ Simple choices ke liye best</p>
                            </div>
                            <div class="feature-card">
                                <h5>ğŸƒ Card Buttons</h5>
                                <p>â€¢ Click ke baad visible rehte hain<br>â€¢ Card ke andar embedded<br>â€¢ Complex interactions ke liye</p>
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ“š <strong>Use Cases:</strong><br><br>
                        â€¢ "Yes" / "No" confirmation<br>
                        â€¢ Language selection: "Hindi" / "English"<br>
                        â€¢ Quick menu: "Order Status" / "Track Package" / "Contact Support"<br><br>
                        
                        <em>Suggested Actions se typing kam hoti hai aur user experience smooth hota hai!</em>
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ <strong>Python Code â€” 08.suggested-actions sample se!</strong>
                    </div>

                    <pre class="language-python line-numbers"><code># Python Suggested Actions â€” from 08.suggested-actions sample
from botbuilder.core import ActivityHandler, MessageFactory, TurnContext
from botbuilder.schema import CardAction, ActionTypes, SuggestedActions

class SuggestActionsBot(ActivityHandler):
    """
    Suggested Actions â€” Quick reply buttons jo click ke baad disappear!
    User ko options do, typing ki zaroorat nahi.
    """
    
    async def on_message_activity(self, turn_context: TurnContext):
        # User ke response ko process karo
        text = turn_context.activity.text.lower()
        
        if text == "red":
            response = "Red is the best color, I agree! ğŸ”´"
        elif text == "blue":
            response = "Blue is the best color, I agree! ğŸ”µ"
        else:
            response = "Please select a color"
        
        await turn_context.send_activity(MessageFactory.text(response))
        
        # Suggested Actions wapas bhejo
        return await self._send_suggested_actions(turn_context)
    
    async def _send_suggested_actions(self, turn_context: TurnContext):
        """
        Suggested Actions ke saath message bhejo.
        Buttons click hone pe disappear ho jaate hain!
        """
        reply = MessageFactory.text("What is your favorite color?")
        
        # SuggestedActions attach karo
        reply.suggested_actions = SuggestedActions(
            actions=[
                CardAction(
                    title="Red",
                    type=ActionTypes.im_back,  # im_back = message visible in chat
                    value="Red",
                    image="https://via.placeholder.com/20/FF0000?text=R"
                ),
                CardAction(
                    title="Blue", 
                    type=ActionTypes.im_back,
                    value="Blue",
                    image="https://via.placeholder.com/20/0000FF?text=B"
                ),
                CardAction(
                    title="Yellow",
                    type=ActionTypes.im_back,
                    value="Yellow"
                )
            ]
        )
        
        return await turn_context.send_activity(reply)</code></pre>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ’» <strong>C# Version:</strong>
                    </div>

                    <pre class="language-csharp line-numbers"><code>// C# Example - Suggested Actions
var reply = MessageFactory.Text("Do you want to continue?");
reply.SuggestedActions = new SuggestedActions()
{
    Actions = new List&lt;CardAction&gt;()
    {
        new CardAction() { Title = "Yes", Type = ActionTypes.ImBack, Value = "Yes" },
        new CardAction() { Title = "No", Type = ActionTypes.ImBack, Value = "No" },
        new CardAction() { Title = "Maybe", Type = ActionTypes.ImBack, Value = "Maybe" }
    }
};
await turnContext.SendActivityAsync(reply, cancellationToken);</code></pre>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 21: Bot Framework Composer ==================== -->
        <section class="topic-section" id="composer">
            <header class="topic-header">
                <div class="topic-badge">ğŸ¨ Chapter 21 â€” Bot Framework Composer</div>
                <h2>Composer â€” Visual Bot Authoring!</h2>
                <p class="topic-subtitle">No-code/low-code bot development â€” drag and drop!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ¨</div>
                    <h3 class="section-title">Bot Framework Composer Kya Hai?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Bot Framework Composer</span> ek open-source IDE hai jo visual authoring canvas provide karta hai. SDK pe built hai but <strong>visual interface</strong> se bots banao!
                    </p>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h5>ğŸ¨ Visual Canvas</h5>
                            <p>Drag-and-drop interface â€” code likhne ki zaroorat kam!</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ“ Adaptive Dialogs</h5>
                            <p>Natural conversation flows design karo visually</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ§  LU Integration</h5>
                            <p>Language Understanding directly Composer mein configure karo</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ”§ Extensible</h5>
                            <p>Code se extend kar sakte ho jab visual tools enough na ho</p>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ’¡ <strong>Composer vs SDK Direct:</strong><br><br>
                        <strong>Use Composer when:</strong><br>
                        â€¢ Quickly prototype karna ho<br>
                        â€¢ Non-developers bhi contribute karein<br>
                        â€¢ Visual flow design chahiye<br><br>
                        
                        <strong>Use SDK Direct when:</strong><br>
                        â€¢ Complex custom logic chahiye<br>
                        â€¢ Full code control chahiye<br>
                        â€¢ Existing codebase mein integrate karna ho<br><br>
                        
                        <em>Pro Tip: Dono combine bhi kar sakte ho â€” Composer se start karo, code se extend karo!</em>
                    </div>

                    <div class="hinglish-note" style="background: rgba(255, 157, 67, 0.1); border-left-color: var(--accent-orange);">
                        âš ï¸ <strong>Alternative: Microsoft Copilot Studio</strong><br><br>
                        Agar pure no-code solution chahiye toh <strong>Microsoft Copilot Studio</strong> consider karo â€” SaaS platform hai, aur bhi easy!<br>
                        Composer is great for developers who want visual tools but also want code access.
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 7: Conversational UX ==================== -->
        <section class="topic-section" id="cux">
            <header class="topic-header">
                <div class="topic-badge">ğŸ¨ Chapter 7 â€” Design Principles</div>
                <h2>Conversational UX (CUX) â€” Great Bot Kaise Banao?</h2>
                <p class="topic-subtitle">Technical knowledge ke saath-saath design principles bhi zaroori hain!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h3 class="section-title">CUX Kya Hai?</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        <span class="highlight">Conversational User Experience (CUX)</span> ek modality of interaction hai jo <strong>natural language pe based</strong> hai. Jaise humans ek dusre se baat karte hain â€” conversation ke through ideas, concepts, data share karte hain â€” CUX wahi experience devices aur apps ke saath provide karta hai!
                    </p>

                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ’¡ <strong>CUX vs Traditional UI:</strong><br><br>
                        <strong>Traditional UI</strong> â€” User ko system seekhna padta hai:<br>
                        â†’ Command line syntax<br>
                        â†’ GUI navigation<br>
                        â†’ Touch gestures<br><br>
                        
                        <strong>CUX</strong> â€” System user ko seekhta hai:<br>
                        â†’ Natural language patterns<br>
                        â†’ Colloquialisms (local phrases)<br>
                        â†’ Chit-chat handling<br><br>
                        
                        <em>"Instead of users learning the system, the system learns from users!"</em>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h3 class="section-title">Great Conversational Bot Ke Characteristics</h3>
                </div>
                <div class="section-content">
                    <p class="content-text">
                        Successful bots mein ek common cheez hoti hai â€” <span class="highlight">great conversational user experience!</span>
                    </p>

                    <p class="content-text">
                        Bot design karte waqt ye questions pucho:
                    </p>

                    <ul class="bullet-list">
                        <li>Kya bot <strong>easily user ka problem solve</strong> karta hai with minimal back and forth?</li>
                        <li>Kya bot <strong>better/easier/faster</strong> hai alternatives se (apps, websites, phone calls)?</li>
                        <li>Kya bot un <strong>devices aur platforms</strong> pe run karta hai jo user use karta hai?</li>
                        <li>Kya bot <strong>discoverable aur easy to invoke</strong> hai?</li>
                        <li>Kya bot user ko <strong>guide karta hai</strong> jab woh stuck ho â€” live agent handover ya help provide karta hai?</li>
                    </ul>

                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ¯ <strong>Users Care About Results!</strong><br><br>
                        Users ko farak nahi padta ki bot kitna intelligent hai ya kaunsi technology use hui hai.<br><br>
                        <strong>Users care when:</strong><br>
                        â†’ Bot unka problem <strong>jaldi solve</strong> kare<br>
                        â†’ <strong>Zyada type</strong> na karna pade<br>
                        â†’ <strong>Repeat</strong> na karna pade<br>
                        â†’ Bot <strong>automatically</strong> relevant info yaad rakhe<br><br>
                        
                        <em>Great CUX = User ka kaam easy hona chahiye!</em>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== TOPIC 8: Bot Lifecycle ==================== -->
        <section class="topic-section" id="bot-lifecycle">
            <header class="topic-header">
                <div class="topic-badge">ğŸ”„ Chapter 8 â€” Development Lifecycle</div>
                <h2>Bot Lifecycle â€” Plan se Production Tak!</h2>
                <p class="topic-subtitle">Bot development ke stages â€” kaise plan karo, build karo, test karo, aur deploy karo!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ”„</div>
                    <h3 class="section-title">Bot Development Stages</h3>
                </div>
                <div class="section-content">
                    <div class="visual-box">
                        <h4>ğŸ“‹ Bot Development Lifecycle</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">BOT LIFECYCLE â€” FROM IDEA TO PRODUCTION</div>
                            <div class="mermaid">
flowchart LR
    P["ğŸ“ PLAN"]
    B["ğŸ”¨ BUILD"]
    T["ğŸ§ª TEST"]
    PUB["ğŸš€ PUBLISH"]
    C["ğŸ”— CONNECT"]
    E["ğŸ“Š EVALUATE"]
    
    P --> B --> T --> PUB --> C --> E
    E -.->|"Iterate"| P
    
    style P fill:#3a86ff,color:#fff
    style B fill:#8338ec,color:#fff
    style T fill:#ff9f43,color:#fff
    style PUB fill:#00ff88,color:#000
    style C fill:#0078d4,color:#fff
    style E fill:#ff6b6b,color:#fff
                            </div>
                        </div>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h5>ğŸ“ Plan</h5>
                            <p>Goals samjho, user needs identify karo, design guidelines review karo. Speech, NLU, Q&A capabilities decide karo.</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ”¨ Build</h5>
                            <p>SDK use karke bot develop karo â€” C#, JavaScript, ya Python mein. Azure services integrate karo.</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ§ª Test</h5>
                            <p>Bot Framework Emulator se local testing. Web Chat se remote testing. Unit tests likho.</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸš€ Publish</h5>
                            <p>Bot ko Azure pe deploy karo ya apne own infrastructure pe. Public internet address do.</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ”— Connect</h5>
                            <p>Channels configure karo â€” Teams, Slack, Facebook, etc. Bot multiple platforms pe available ho.</p>
                        </div>
                        <div class="feature-card">
                            <h5>ğŸ“Š Evaluate</h5>
                            <p>Azure Portal mein analytics dekho â€” traffic, latency, user data. Performance improve karo.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== BONUS: ENTERPRISE DEEP DIVE ==================== -->
        <section class="topic-section" id="enterprise-deep-dive">
            <header class="topic-header">
                <div class="topic-badge">ğŸ¢ BONUS Chapter â€” Enterprise Deep Dive</div>
                <h2>Production ABS Infrastructure â€” Real Code Se Samjho!</h2>
                <p class="topic-subtitle">Microsoft ka actual Intercom codebase â€” WhatsApp, DirectLine, Token Service, Channel Connectors!</p>
            </header>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">ğŸ¯</div>
                    <h3 class="section-title">Kahani Shuru â€” Message Ka Safar Samjho!</h3>
                </div>
                <div class="section-content">
                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“– <strong>Imagine Karo â€” Ek WhatsApp Message Ka Journey!</strong><br><br>
                        
                        <strong>Scene 1:</strong> Tumhara friend "Ravi" apne phone pe WhatsApp kholta hai aur type karta hai: <em>"Pizza order karna hai"</em><br><br>
                        
                        <strong>Question:</strong> Ye message tumhare bot tak kaise pahunchta hai? ğŸ¤”<br><br>
                        
                        <strong>Answer:</strong> Bahut lambi journey hai bhai! WhatsApp â†’ Azure Communication Services â†’ Channel Connector â†’ Bot Connector â†’ Tumhara Bot!<br><br>
                        
                        <em>Chalo step-by-step samjhte hain enterprise code ke saath...</em>
                    </div>

                    <div class="visual-box">
                        <h4>ğŸ—ºï¸ Message Journey â€” WhatsApp to Bot</h4>
                        <div class="mermaid-container">
                            <div class="diagram-label">ENTERPRISE MESSAGE FLOW â€” PRODUCTION INFRASTRUCTURE</div>
                            <div class="mermaid">
flowchart TB
    subgraph User["ğŸ“± USER DEVICE"]
        WA["WhatsApp App<br/>Message: Pizza order karna hai"]
    end
    
    subgraph Meta["ğŸŒ META SERVERS"]
        WAS["WhatsApp Business API<br/>Webhook trigger"]
    end
    
    subgraph Azure["â˜ï¸ AZURE INFRASTRUCTURE"]
        ACS["Azure Communication Services<br/>Message receive"]
        WC["WhatsApp Channel Connector<br/>âœ¨ Message normalization"]
        BC["Bot Connector Service<br/>ğŸ” JWT Authentication"]
    end
    
    subgraph Bot["ğŸ¤– YOUR BOT"]
        BL["Bot Logic<br/>Process & Respond"]
    end
    
    User -->|"1. User types"| Meta
    Meta -->|"2. Webhook"| ACS
    ACS -->|"3. Event"| WC
    WC -->|"4. Activity"| BC
    BC -->|"5. POST /api/messages"| Bot
    Bot -->|"6. Response"| BC
    BC -->|"7. Reply"| WC
    WC -->|"8. Send"| Meta
    Meta -->|"9. Deliver"| User
    
    style WA fill:#25D366,color:#fff
    style WC fill:#0078d4,color:#fff
    style BC fill:#ff9f43,color:#fff
    style BL fill:#00ff88,color:#000
                            </div>
                        </div>
                    </div>

                    <div class="hinglish-note" style="background: rgba(255, 157, 67, 0.1); border-left-color: var(--accent-orange);">
                        ğŸ”¥ <strong>Ye Sab Enterprise Infra Hai!</strong><br><br>
                        Jo tum Azure Portal mein "Add Channel" click karke WhatsApp add karte ho â€” uske peeche ye sab code chal raha hai!<br><br>
                        Intercom codebase mein <strong>5575+ C# files</strong> hain jo ye sab handle karte hain!
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h3 class="section-title">Activity Schema â€” Bot Framework Ka Universal Language</h3>
                </div>
                <div class="section-content">
                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ“š <strong>Kahani Continue â€” Activity Kya Hai?</strong><br><br>
                        
                        Socho WhatsApp ka message format alag hai, Facebook ka alag hai, Teams ka alag hai.<br>
                        Agar tumhe har platform ke liye alag code likhna pade toh pagal ho jaoge! ğŸ˜µ<br><br>
                        
                        <strong>Solution?</strong> Bot Framework ne ek <strong>"Universal Language"</strong> banayi â€” <strong>Activity Schema!</strong><br><br>
                        
                        Har channel ka message pehle <strong>Activity format</strong> mein convert hota hai, phir tumhare bot ko milta hai.<br>
                        Tum ek code likho, wo sab platforms pe kaam kare! ğŸ‰
                    </div>

                    <pre class="language-csharp line-numbers"><code>// Activity Class â€” The Universal Message Format (From Intercom/ChannelSDK)
// Ye class Bot Framework 3.0 protocol ka core hai!

namespace Microsoft.Bot.Schema
{
    /// &lt;summary&gt;
    /// Activity is the UNIVERSAL communication format!
    /// Chahe WhatsApp se message aaye ya Teams se â€” sab Activity ban jaata hai.
    /// 
    /// Kahani: Imagine Activity ko ek "translator" samjho.
    /// WhatsApp Hindi bolti hai, Teams English bolti hai, Facebook French bolti hai.
    /// Activity sabko ek hi language mein convert kar deta hai!
    /// &lt;/summary&gt;
    public class Activity :
        IActivity,
        IMessageActivity,           // ğŸ’¬ Normal messages
        IConversationUpdateActivity, // ğŸ‘‹ Join/Leave events  
        ITypingActivity,            // âŒ¨ï¸ User is typing...
        IEventActivity,             // ğŸ”” Custom events
        IInvokeActivity,            // âš¡ Sync operations
        ICommandActivity            // ğŸ® Commands
    {
        // ğŸ¯ Activity Types â€” Har type of interaction
        public static IMessageActivity CreateMessageActivity() 
            => new Activity(ActivityTypes.Message);
            
        public static ITypingActivity CreateTypingActivity() 
            => new Activity(ActivityTypes.Typing);
            
        public static IConversationUpdateActivity CreateConversationUpdateActivity() 
            => new Activity(ActivityTypes.ConversationUpdate);
        
        // ğŸ” Check Activity Type â€” Bot logic mein use karo
        public IMessageActivity AsMessageActivity() 
            => IsActivity(ActivityTypes.Message) ? this : null;
            
        public ITypingActivity AsTypingActivity() 
            => IsActivity(ActivityTypes.Typing) ? this : null;
    }
}</code></pre>

                    <pre class="language-csharp line-numbers"><code>// Activity Types â€” Saari Activity Types Define Hain Yahaan!
namespace Microsoft.Bot.Schema
{
    /// &lt;summary&gt;
    /// Ye constants hain jo bataate hain activity kis type ki hai.
    /// 
    /// Kahani: Jaise letters ke types hote hain (normal, registered, speed post),
    /// waise hi messages ke types hote hain!
    /// &lt;/summary&gt;
    public class ActivityTypes
    {
        // ğŸ’¬ Normal message â€” "Hello", "Pizza order karo"
        public const string Message = "message";
        
        // ğŸ‘‹ User join/leave â€” Group mein koi aaya ya gaya
        public const string ConversationUpdate = "conversationUpdate";
        
        // âŒ¨ï¸ Typing indicator â€” "User is typing..."
        public const string Typing = "typing";
        
        // ğŸ”š Conversation end â€” "Bye bye!"
        public const string EndOfConversation = "endOfConversation";
        
        // ğŸ”” Event â€” External trigger jaise "payment successful"
        public const string Event = "event";
        
        // âš¡ Invoke â€” Synchronous call with response expected
        public const string Invoke = "invoke";
        
        // âœï¸ Message updated â€” User ne apna message edit kiya
        public const string MessageUpdate = "messageUpdate";
        
        // ğŸ—‘ï¸ Message deleted â€” User ne message delete kiya
        public const string MessageDelete = "messageDelete";
        
        // ğŸ‘ Reaction â€” Like, love, laugh
        public const string MessageReaction = "messageReaction";
        
        // ğŸ¤ Handoff â€” Live agent ko transfer
        public const string Handoff = "handoff";
    }
}</code></pre>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h3 class="section-title">Channel Connector Interface â€” Gateway to Channels</h3>
                </div>
                <div class="section-content">
                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ“š <strong>Kahani Continue â€” Connector Ka Kaam!</strong><br><br>
                        
                        Ab samjho Channel Connector kya karta hai...<br><br>
                        
                        Socho tumhare bot ne response diya: <em>"Pizza order confirmed! ğŸ•"</em><br><br>
                        
                        Lekin ye response user tak kaise pahunchega? WhatsApp ko directly nahi bhej sakte!<br><br>
                        
                        <strong>IChannelConnector</strong> wo interface hai jo bot aur channel ke beech <strong>"translator + delivery boy"</strong> ka kaam karta hai!<br>
                        â†’ Bot se message lo<br>
                        â†’ Channel ke format mein convert karo<br>
                        â†’ User tak deliver karo<br>
                    </div>

                    <pre class="language-csharp line-numbers"><code>// IChannelConnector â€” The Gateway Interface (From Intercom/ChannelSDK)
// Har channel (WhatsApp, Teams, Slack) ka apna connector hota hai jo ye interface implement karta hai.

namespace Microsoft.Bot.ChannelConnector
{
    /// &lt;summary&gt;
    /// Bot ke liye channel se baat karne ka doorway!
    /// 
    /// Kahani: Ye ek "Embassy" jaisa hai.
    /// Agar bot India hai aur WhatsApp USA hai, toh Connector unke beech ka Embassy hai
    /// jo messages translate karke deliver karta hai!
    /// &lt;/summary&gt;
    public interface IChannelConnector
    {
        /// &lt;summary&gt;
        /// Channel ka unique identifier â€” "whatsapp", "teams", "slack", etc.
        /// &lt;/summary&gt;
        string ChannelId { get; }

        /// &lt;summary&gt;
        /// Nayi conversation start karo!
        /// Jaise WhatsApp pe "Start Chat" karna.
        /// &lt;/summary&gt;
        Task&lt;ConversationResourceResponse&gt; CreateConversationAsync(
            ActivityContext context, 
            ConversationParameters parameters);

        /// &lt;summary&gt;
        /// ğŸ’¬ Bot ka message user ko bhejo!
        /// Ye sabse zyada use hone wala method hai.
        /// 
        /// Example: Bot bola "Pizza order confirmed!" 
        /// â†’ Ye method isko WhatsApp message mein convert karke bhejega
        /// &lt;/summary&gt;
        Task&lt;ResourceResponse&gt; SendMessageActivityToUserAsync(
            ActivityContext context, 
            IMessageActivity messageActivity);

        /// &lt;summary&gt;
        /// âŒ¨ï¸ Typing indicator bhejo â€” "Bot is typing..."
        /// User ko pata chale ki bot reply kar raha hai!
        /// &lt;/summary&gt;
        Task&lt;ResourceResponse&gt; SendTypingActivityToUserAsync(
            ActivityContext context, 
            ITypingActivity typingActivity);

        /// &lt;summary&gt;
        /// ğŸ”š Conversation end karo
        /// "Thank you for chatting! Goodbye!"
        /// &lt;/summary&gt;
        Task&lt;ResourceResponse&gt; SendEndOfConversationActivityToUserAsync(
            ActivityContext context, 
            IEndOfConversationActivity endOfConversationActivity);

        /// &lt;summary&gt;
        /// âœï¸ Message update karo â€” already sent message ko edit karo
        /// Note: Sab channels support nahi karte (WhatsApp nahi karta)
        /// &lt;/summary&gt;
        Task&lt;ResourceResponse&gt; UpdateActivity(
            ActivityContext context, 
            IActivity activity);

        /// &lt;summary&gt;
        /// ğŸ—‘ï¸ Message delete karo
        /// Note: Sab channels support nahi karte
        /// &lt;/summary&gt;
        Task&lt;ErrorResponse&gt; DeleteActivity(
            ActivityContext context, 
            string conversationId, 
            string activityId);

        /// &lt;summary&gt;
        /// ğŸ‘¥ Conversation ke members list karo
        /// Group chat mein kaun-kaun hai?
        /// &lt;/summary&gt;
        Task&lt;ChannelAccount[]&gt; GetMembersAsync(
            APIContext context, 
            string conversationId, 
            string messageId);
    }
}</code></pre>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <h3 class="section-title">WhatsApp Message Mapping â€” Real Transformation!</h3>
                </div>
                <div class="section-content">
                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“š <strong>Kahani Continue â€” WhatsApp to Activity Transformation!</strong><br><br>
                        
                        Ab real code dekhte hain â€” WhatsApp message kaise Activity ban jaata hai!<br><br>
                        
                        <strong>Step 1:</strong> User ne WhatsApp pe type kiya: "2 large pizzas"<br>
                        <strong>Step 2:</strong> WhatsApp API ne ye message JSON format mein bheja<br>
                        <strong>Step 3:</strong> WhatsAppOutgoingMessageMapper ne isko Bot Framework Activity mein convert kiya<br>
                        <strong>Step 4:</strong> Ab tumhara bot isko samajh sakta hai!<br><br>
                        
                        <em>Ye "normalization" ka jaadu hai â€” ek format se doosre mein conversion!</em>
                    </div>

                    <pre class="language-csharp line-numbers"><code>// WhatsApp Outgoing Message Mapper â€” Bot Response to WhatsApp Format
// From: Intercom/Channels/WhatsAppChannel â€” Production Code!

namespace WhatsApp.Core.Mapper
{
    /// &lt;summary&gt;
    /// Bot ke Activity ko WhatsApp message mein convert karo!
    /// 
    /// Kahani: Bot ne bola "Your order is confirmed! ğŸ•"
    /// Ab isko WhatsApp samjhe aise format mein convert karna hai.
    /// &lt;/summary&gt;
    public class WhatsAppOutgoingMessageMapper
    {
        // WhatsApp message limit â€” 4096 characters max
        private int _messageTextLimit = Constants.MessageTextLimit;

        /// &lt;summary&gt;
        /// IMessageActivity â†’ WhatsApp Envelope(s) mein convert karo!
        /// 
        /// Note: Ek Activity se multiple envelopes ban sakte hain!
        /// Kyunki agar text + attachments hain toh alag-alag messages jayenge.
        /// &lt;/summary&gt;
        public List&lt;WhatsAppOutgoingMessageEnvelope&gt; ActivityToEnvelope(
            IMessageActivity messageActivity, 
            string botID, 
            string botRegion, 
            CancellationToken cancellationToken)
        {
            List&lt;WhatsAppOutgoingMessageEnvelope&gt; envelopes = new List&lt;WhatsAppOutgoingMessageEnvelope&gt;();

            // 1ï¸âƒ£ Text Message Handle Karo
            string text = GetMessageActivityText(messageActivity);
            
            if (!string.IsNullOrEmpty(text))
            {
                // âš ï¸ WhatsApp limit check â€” zyada lamba text toh split karo!
                while (Encoding.UTF8.GetBytes(text).Length > 0)
                {
                    var envelope = CreateResponseEnvelope(messageActivity);
                    int length = text.Length > _messageTextLimit ? _messageTextLimit : text.Length;
                    
                    // Proper UTF-8 boundary pe split karo
                    var textToSet = text.Substring(0, length);
                    while (Encoding.UTF8.GetBytes(textToSet).Length > _messageTextLimit)
                    {
                        length--;
                        textToSet = text.Substring(0, length);
                    }

                    envelope.Data.Content = textToSet;
                    envelope.Data.ContentType = WhatsAppContentType.Text;
                    envelopes.Add(envelope);
                    
                    text = text.Substring(length);  // Remaining text
                }
            }

            // 2ï¸âƒ£ Attachments Handle Karo (Cards, Images, etc.)
            if (messageActivity.Attachments != null)
            {
                foreach (Attachment attachment in messageActivity.Attachments)
                {
                    InteractiveMessage interactiveMessage = null;
                    
                    // ğŸ´ Adaptive Card â†’ WhatsApp Interactive Message
                    if (attachment.ContentType == "application/vnd.microsoft.card.adaptive")
                    {
                        AdaptiveCard card = JsonConvert.DeserializeObject&lt;AdaptiveCard&gt;(
                            ((JObject)attachment.Content).ToString());
                        var renderer = new AdaptiveCardRenderer(card);
                        interactiveMessage = renderer.RenderToACSInteractiveMessage();
                    }
                    // ğŸ” OAuth Card â†’ WhatsApp Sign-in Button
                    else if (attachment.ContentType == "application/vnd.microsoft.card.oauth")
                    {
                        OAuthCard oAuthCard = JsonConvert.DeserializeObject&lt;OAuthCard&gt;(
                            ((JObject)attachment.Content).ToString());
                        var renderer = new OAuthCardRenderer(oAuthCard);
                        interactiveMessage = renderer.RenderToACSInteractiveMessage();
                    }

                    if (interactiveMessage != null)
                    {
                        // WhatsApp Interactive Message create karo
                        var attachmentEnvelope = new WhatsAppOutgoingMessageEnvelope
                        {
                            Id = Guid.NewGuid().ToString(),
                            EventType = "Notification",
                            EventTime = DateTime.UtcNow,
                            Data = new WhatsAppOutgoingMessage()
                            {
                                ContentType = WhatsAppContentType.Interactive,
                                InteractiveContent = interactiveMessage,
                                From = messageActivity.From.Id,
                                To = messageActivity.Recipient.Id
                            }
                        };
                        envelopes.Add(attachmentEnvelope);
                    }
                }
            }

            return envelopes;
        }

        /// &lt;summary&gt;
        /// Markdown â†’ WhatsApp format convert karo!
        /// WhatsApp ka apna formatting hai (*bold*, _italic_, etc.)
        /// &lt;/summary&gt;
        private static string GetMessageActivityText(IMessageActivity messageActivity)
        {
            string text = messageActivity.Text;
            if (string.IsNullOrEmpty(text)) return text;

            // Markdown format toh WhatsApp Markdown mein convert karo
            if (messageActivity.TextFormat == TextFormatTypes.Markdown)
            {
                var marked = new Marked();
                marked.Options.Mangle = false;
                marked.Options.Sanitize = false;
                marked.Options.Renderer = new WhatsAppMarkdownRenderer();
                text = marked.Parse(text);
            }

            return text;
        }
    }
}</code></pre>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <h3 class="section-title">DirectLine WebSocket â€” Real-Time Communication!</h3>
                </div>
                <div class="section-content">
                    <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple);">
                        ğŸ“š <strong>Kahani Continue â€” DirectLine Kya Hai?</strong><br><br>
                        
                        DirectLine ek special channel hai jo <strong>custom apps</strong> ke liye hai!<br><br>
                        
                        <strong>Use Case:</strong><br>
                        â€¢ Apni website pe chat widget lagana hai? â†’ DirectLine use karo!<br>
                        â€¢ Mobile app mein bot integrate karna hai? â†’ DirectLine use karo!<br>
                        â€¢ Custom electron app bana rahe ho? â†’ DirectLine use karo!<br><br>
                        
                        <strong>WebSocket</strong> use hota hai real-time, bi-directional communication ke liye.<br>
                        User type kare â†’ turant bot ko mile â†’ turant response aaye!<br><br>
                        
                        <em>HTTP polling se 100x faster hai WebSocket! âš¡</em>
                    </div>

                    <pre class="language-csharp line-numbers"><code>// DirectLine WebSocket â€” Real-Time Chat Infrastructure
// From: Intercom/Channels/DirectLineChannel â€” Enterprise Production Code!

namespace DirectLine.Controllers
{
    /// &lt;summary&gt;
    /// WebSocket connection manager for DirectLine channel!
    /// 
    /// Kahani: HTTP request-response slow hai. Har baar connection kholo, message bhejo, band karo.
    /// WebSocket ek baar connection kholo, phir freely messages aate-jaate rahen! ğŸš€
    /// &lt;/summary&gt;
    public class DirectLineWebSocket : IWebSocket, IDisposable
    {
        // ğŸ“Š Metrics tracking â€” kitne sockets connected hain
        private static readonly CounterMetric _socketsConnected = 
            new CounterMetric("SOCKET: Number sockets connected", AppInsights.AzureHostingDetails);
        private static readonly CounterMetric _bytesSent = 
            new CounterMetric("SOCKET: Bytes sent", AppInsights.AzureHostingDetails);

        // ğŸ”‘ Socket state
        private WebSocket _socket;
        private readonly string _conversationId;
        private DateTime _lastMessageTime = DateTime.UtcNow;

        /// &lt;summary&gt;
        /// Unique identifier for this socket connection
        /// &lt;/summary&gt;
        public string Id { get; } = Guid.NewGuid().ToString();

        /// &lt;summary&gt;
        /// WebSocket start karo aur messages listen karo!
        /// 
        /// Ye method long-running hai â€” jab tak user connected hai, ye chalta rahega.
        /// &lt;/summary&gt;
        public async Task RunAsync(WebSocket ws, string startingWatermark)
        {
            _socket = ws;
            _socketsConnected.Increment();

            try
            {
                // 1ï¸âƒ£ Register this socket for the conversation
                _sockets.TryAdd(_context.Conversation.ConversationId, this);

                // 2ï¸âƒ£ Start listening for messages (runs forever until disconnected)
                await ReceiveLoop();

                // 3ï¸âƒ£ Send periodic ping to keep connection alive
                _runner.RunForever(async token =>
                {
                    await SendPingAsync();
                    return await GetLivenessIntervalAsync();
                }, TimeSpan.FromSeconds(60), "WebSocketPing");
            }
            finally
            {
                // 4ï¸âƒ£ Cleanup on disconnect
                _socketsConnected.Decrement();
                _sockets.TryRemove(_context.Conversation.ConversationId, out _);
            }
        }

        /// &lt;summary&gt;
        /// Bot se user ko message bhejo via WebSocket!
        /// 
        /// Ye method queue-based hai â€” fast delivery ensure karta hai.
        /// &lt;/summary&gt;
        public async Task SendAsync(Activity activity)
        {
            // Duplicate check â€” same message dobara na bheje
            if (_sentActivities.Contains(activity.Id))
                return;
            _sentActivities.Add(activity.Id);

            // Serialize and send
            string json = JsonConvert.SerializeObject(activity);
            byte[] bytes = Encoding.UTF8.GetBytes(json);
            
            await _socket.SendAsync(
                new ArraySegment&lt;byte&gt;(bytes), 
                WebSocketMessageType.Text, 
                endOfMessage: true, 
                CancellationToken.None);

            _bytesSent.Increment(bytes.Length);
            _lastMessageTime = DateTime.UtcNow;
        }

        /// &lt;summary&gt;
        /// Connection alive check karo!
        /// Stale connections ko aggressive ping karo.
        /// &lt;/summary&gt;
        private async Task&lt;TimeSpan&gt; GetLivenessIntervalAsync()
        {
            // Agar 1 hour se zyada idle hai â†’ more frequent pings
            bool isStaleSocket = (DateTime.UtcNow - _lastMessageTime) > TimeSpan.FromHours(1);
            
            return isStaleSocket 
                ? TimeSpan.FromSeconds(30)   // Stale socket â€” ping every 30 sec
                : TimeSpan.FromSeconds(60);  // Active socket â€” ping every 60 sec
        }
    }
}</code></pre>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <h3 class="section-title">OAuth Controller â€” User Authentication Magic!</h3>
                </div>
                <div class="section-content">
                    <div class="hinglish-note" style="background: rgba(0, 212, 255, 0.1); border-left-color: var(--accent-blue);">
                        ğŸ“š <strong>Kahani Continue â€” Login Flow Samjho!</strong><br><br>
                        
                        User ne bot se bola: <em>"Show my calendar"</em><br><br>
                        
                        Bot ko Microsoft Graph API call karni hai calendar dekhne ke liye.<br>
                        But wait! User ka permission chahiye pehle! ğŸ”<br><br>
                        
                        <strong>OAuth Flow:</strong><br>
                        1. Bot user ko "Sign in" button bhejta hai<br>
                        2. User click kare â†’ Azure AD login page khule<br>
                        3. User login kare â†’ Token generate ho<br>
                        4. Token bot ko mile â†’ Ab Graph API call ho sakti hai!<br><br>
                        
                        <em>Ye secure way hai user ke data access karne ka!</em>
                    </div>

                    <pre class="language-csharp line-numbers"><code>// OAuth Controller â€” User Authentication Endpoint
// From: Intercom/Intercom.Switch â€” Production Auth Infrastructure!

namespace Intercom.Switch.Controllers
{
    /// &lt;summary&gt;
    /// OAuth flow ka main controller!
    /// 
    /// Kahani: Ye controller "Security Guard" jaisa hai.
    /// User ko pehle ID verify karwani padti hai (Azure AD se),
    /// phir hi sensitive operations allow hote hain!
    /// &lt;/summary&gt;
    [RoutePrefix("api/oauth")]
    [HandleAPIException]
    public class OAuthController : ApiController
    {
        // Teams SDK versions â€” different versions ke liye different scripts
        private const string teams218Imports = 
            "&lt;script src='https://res.cdn.office.net/teams-js/2.18.0/js/MicrosoftTeams.min.js'&gt;&lt;/script&gt;";

        private readonly IJwtTokenSender _jwtTokenSender;
        private readonly ISignInCache _signInCache;
        private readonly IMagicCodeCache _magicCodeCache;

        /// &lt;summary&gt;
        /// User Sign-In initiate karo!
        /// 
        /// Process:
        /// 1. SignIn request aaye
        /// 2. Azure AD ke login URL generate karo
        /// 3. User ko redirect karo
        /// 4. User login kare â†’ callback aaye
        /// 5. Token store karo â†’ bot ko de do
        /// &lt;/summary&gt;
        [HttpGet]
        [Route("SignIn")]
        public async Task&lt;HttpResponseMessage&gt; SignIn(
            string settingId = null,
            string redirectUri = null,
            string signin = null,
            string fwdUrl = null)
        {
            AppInsights.TrackEventEx("OAuthController.SignIn",
                "Setting ID", settingId,
                "RedirectUri", redirectUri);

            string signInLocation;
            
            if (!string.IsNullOrEmpty(signin))
            {
                // Code challenge for PKCE security
                string codeChallenge = String.Empty;
                int codeChallengeIndex = signin.IndexOf("&code_challenge=");
                
                if (codeChallengeIndex != -1)
                {
                    codeChallenge = signin.Substring(codeChallengeIndex);
                    signin = signin.Substring(0, codeChallengeIndex);
                }

                // SignIn state cache se get karo
                var signInState = await _signInCache.GetSignInStateAsync(signin);

                if (signInState == null)
                {
                    // State expired ya invalid â€” error return karo
                    return CreateNoSignInResponse();
                }
                
                // Forward URL update karo agar needed
                if (!string.IsNullOrWhiteSpace(fwdUrl) && 
                    string.IsNullOrWhiteSpace(signInState.ForwardUrl))
                {
                    signInState.ForwardUrl = fwdUrl;
                }

                // Azure AD login URL generate karo
                signInLocation = await BuildSignInUrlAsync(signInState, codeChallenge);
            }

            // Redirect to login page
            return Request.CreateResponse(HttpStatusCode.Redirect, signInLocation);
        }

        /// &lt;summary&gt;
        /// Magic Code verify karo!
        /// 
        /// Magic Code = 6-digit code jo user ko dikhta hai login ke baad.
        /// User ye code bot mein type karta hai â†’ bot verify karta hai.
        /// Ye extra security layer hai "man-in-the-middle" attacks se bachne ke liye!
        /// &lt;/summary&gt;
        [HttpPost]
        [Route("VerifyMagicCode")]
        public async Task&lt;HttpResponseMessage&gt; VerifyMagicCode(
            string code, 
            string conversationId)
        {
            // Cache se check karo code valid hai ya nahi
            var storedCode = await _magicCodeCache.GetAsync(conversationId);
            
            if (storedCode == null || storedCode != code)
            {
                return Request.CreateResponse(HttpStatusCode.Unauthorized, "Invalid code");
            }

            // Code valid hai â€” token return karo
            var token = await GetUserTokenAsync(conversationId);
            return Request.CreateResponse(HttpStatusCode.OK, token);
        }
    }
}</code></pre>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <h3 class="section-title">Enterprise Bot Template â€” Production-Ready Code!</h3>
                </div>
                <div class="section-content">
                    <div class="hinglish-note" style="background: rgba(0, 255, 136, 0.1); border-left-color: var(--accent-green);">
                        ğŸ“š <strong>Final Piece â€” Full Bot Application!</strong><br><br>
                        
                        Ab tak individual components dekhe. Ab complete bot application dekho!<br><br>
                        
                        <strong>3 Main Files:</strong><br>
                        1. <strong>BotController.cs</strong> â€” HTTP endpoint jo messages receive kare<br>
                        2. <strong>AdapterWithErrorHandler.cs</strong> â€” Error handling + middleware<br>
                        3. <strong>EchoBot.cs</strong> â€” Actual bot logic<br><br>
                        
                        <em>Ye pattern follow karo production bots ke liye!</em>
                    </div>

                    <pre class="language-csharp line-numbers"><code>// Bot Controller â€” HTTP Endpoint (From: BotAppTemplates/EchoBot)
// Ye ASP.NET Core controller hai jo /api/messages pe listen karta hai.

namespace Microsoft.BotBuilderSamples.Controllers
{
    /// &lt;summary&gt;
    /// Main entry point for all bot messages!
    /// 
    /// Kahani: Ye "Reception Desk" hai tumhare office ki.
    /// Sabhi messages pehle yahaan aate hain, phir proper department ko forward hote hain.
    /// &lt;/summary&gt;
    [Route("api/messages")]
    [ApiController]
    public class BotController : ControllerBase
    {
        private readonly IBotFrameworkHttpAdapter Adapter;
        private readonly IBot Bot;

        // Dependency Injection â€” ASP.NET Core automatically inject karega
        public BotController(IBotFrameworkHttpAdapter adapter, IBot bot)
        {
            Adapter = adapter;
            Bot = bot;
        }

        /// &lt;summary&gt;
        /// POST /api/messages â€” Ye endpoint Bot Connector Service call karta hai!
        /// 
        /// Flow:
        /// 1. User message bheje â†’ Channel receive kare
        /// 2. Channel â†’ Bot Connector Service ko forward kare
        /// 3. Bot Connector â†’ Ye endpoint call kare
        /// 4. Adapter message process kare â†’ Bot logic run ho
        /// 5. Response wapas jaaye reverse path se
        /// &lt;/summary&gt;
        [HttpPost, HttpGet]
        public async Task PostAsync()
        {
            // Adapter does all the heavy lifting!
            // - Authentication verify karta hai
            // - Activity deserialize karta hai
            // - Middleware pipeline run karta hai
            // - Bot ko call karta hai
            await Adapter.ProcessAsync(Request, Response, Bot);
        }
    }
}</code></pre>

                    <pre class="language-csharp line-numbers"><code>// Adapter With Error Handler â€” Graceful Error Handling
// Production mein errors handle karna MUST hai!

namespace Microsoft.BotBuilderSamples
{
    /// &lt;summary&gt;
    /// Custom adapter jo errors gracefully handle kare!
    /// 
    /// Kahani: Kabhi kabhi code crash hota hai (null reference, API timeout, etc.)
    /// Bina error handling ke bot "silent death" mar jaata hai.
    /// User ko kuch nahi dikhta â€” bad UX! ğŸ˜
    /// 
    /// Is adapter se errors catch hote hain aur user ko friendly message milta hai.
    /// &lt;/summary&gt;
    public class AdapterWithErrorHandler : BotFrameworkHttpAdapter
    {
        public AdapterWithErrorHandler(
            IConfiguration configuration, 
            ILogger&lt;BotFrameworkHttpAdapter&gt; logger)
            : base(configuration, logger)
        {
            // ğŸ”¥ OnTurnError â€” Jab bhi koi error aaye, ye handler run hoga
            OnTurnError = async (turnContext, exception) =>
            {
                // 1ï¸âƒ£ Log the error â€” Azure App Insights mein jaayega
                logger.LogError(exception, 
                    $"[OnTurnError] unhandled error : {exception.Message}");

                // 2ï¸âƒ£ User ko friendly message bhejo
                await turnContext.SendActivityAsync(
                    "Oops! Something went wrong. Please try again.");

                // 3ï¸âƒ£ Development mein detailed error bhejo (optional)
                // Production mein ye disable karo!
                await turnContext.TraceActivityAsync(
                    "OnTurnError Trace", 
                    exception.Message, 
                    "https://www.botframework.com/schemas/error", 
                    "TurnError");
            };
        }
    }
}</code></pre>

                    <pre class="language-csharp line-numbers"><code>// Startup.cs â€” Dependency Injection Configuration
// ASP.NET Core application ka heart!

namespace Microsoft.BotBuilderSamples
{
    /// &lt;summary&gt;
    /// Application startup configuration!
    /// 
    /// Kahani: Ye "Recipe Book" hai tumhare restaurant ki.
    /// Kaunse ingredients (services) chahiye, kaise mix karne hain (configure),
    /// sab yahaan define hota hai!
    /// &lt;/summary&gt;
    public class Startup
    {
        public void ConfigureServices(IServiceCollection services)
        {
            services.AddControllers().AddNewtonsoftJson();

            // ğŸ”Œ Adapter register karo â€” error handling wala
            services.AddSingleton&lt;IBotFrameworkHttpAdapter, AdapterWithErrorHandler&gt;();

            // ğŸ¤– Bot register karo â€” har request pe naya instance (transient)
            services.AddTransient&lt;IBot, EchoBot&gt;();
            
            // ğŸ’¾ Optional: State management add karo
            // services.AddSingleton&lt;IStorage, MemoryStorage&gt;();
            // services.AddSingleton&lt;ConversationState&gt;();
            // services.AddSingleton&lt;UserState&gt;();
        }

        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
        {
            if (env.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
            }

            app.UseDefaultFiles()
               .UseStaticFiles()
               .UseWebSockets()  // DirectLine WebSocket ke liye
               .UseRouting()
               .UseAuthorization()
               .UseEndpoints(endpoints =>
               {
                   endpoints.MapControllers();
               });
        }
    }
}</code></pre>
                </div>
            </div>

            <div class="summary-card" style="margin-top: 2rem;">
                <h3 class="summary-title">ğŸ“ Enterprise Deep Dive â€” Summary!</h3>
                <p class="content-text">
                    Is BONUS chapter mein tumne dekha:
                </p>
                <ul class="bullet-list">
                    <li><strong>Message Journey</strong> â€” WhatsApp se Bot tak ka complete flow</li>
                    <li><strong>Activity Schema</strong> â€” Universal message format (5575+ files mein use hota hai!)</li>
                    <li><strong>IChannelConnector</strong> â€” Gateway interface jo channels se communicate kare</li>
                    <li><strong>WhatsApp Mapper</strong> â€” Activity â†” WhatsApp format conversion</li>
                    <li><strong>DirectLine WebSocket</strong> â€” Real-time communication for custom apps</li>
                    <li><strong>OAuth Controller</strong> â€” User authentication flow</li>
                    <li><strong>Production Template</strong> â€” Complete bot application structure</li>
                </ul>
                <div class="hinglish-note" style="background: rgba(168, 85, 247, 0.1); border-left-color: var(--accent-purple); margin-top: 1rem;">
                    ğŸš€ <strong>Ab Tum Ready Ho!</strong><br><br>
                    MS Learn concepts + Enterprise production code dono tumhare paas hain!<br>
                    Intercom codebase Azure Bot Service ki actual infrastructure hai jo <strong>millions of bots</strong> ko power karti hai.<br><br>
                    <em>"Theory + Real Code = Complete Understanding! ğŸ‰"</em>
                </div>
            </div>
        </section>

        <!-- ==================== SUMMARY ==================== -->
        <div class="summary-card">
            <h3 class="summary-title">ğŸ“ ABS Notes â€” Complete Summary (21 Chapters + Enterprise Deep Dive)</h3>

            <div class="visual-box">
                <h4>ğŸ“‹ All Topics Covered â€” MS Learn Complete!</h4>
                <div class="mermaid-container">
                    <div class="diagram-label">AZURE BOT SERVICE â€” COMPLETE LEARNING PATH</div>
                    <div class="mermaid">
flowchart TB
    subgraph Basics["ğŸš€ BASICS (Ch 1-6)"]
        B1["Introduction"]
        B2["Bot Concept"]
        B3["Activities/Turns"]
        B4["Architecture"]
        B5["State Mgmt"]
        B6["Channels"]
    end
    
    subgraph Dialogs["ğŸ’¬ DIALOGS (Ch 7-10)"]
        D1["Dialog Library"]
        D2["Waterfall"]
        D3["Prompts"]
        D4["Activity Handlers"]
    end
    
    subgraph Rich["ğŸ´ RICH MSG (Ch 11-13)"]
        R1["Cards"]
        R2["Adaptive Cards"]
        R3["Proactive Msg"]
    end
    
    subgraph Advanced["ğŸ”§ ADVANCED (Ch 14-21)"]
        A1["NLU/CLU"]
        A2["Skills"]
        A3["Testing"]
        A4["Deploy"]
        A5["Auth/OAuth"]
        A6["Teams"]
        A7["Suggested Actions"]
        A8["Composer"]
    end
    
    Basics --> Dialogs --> Rich --> Advanced
    
    style B1 fill:#3a86ff,color:#fff
    style D1 fill:#8338ec,color:#fff
    style R1 fill:#ff9f43,color:#fff
    style A1 fill:#00ff88,color:#000
                    </div>
                </div>
            </div>

            <div class="feature-grid" style="margin-top: 1.5rem;">
                <div class="feature-card">
                    <h5>ğŸ“š Chapters 1-6</h5>
                    <p>Introduction, Bot basics, Activities, Turns, Architecture, State, Channels</p>
                </div>
                <div class="feature-card">
                    <h5>ğŸ’¬ Chapters 7-10</h5>
                    <p>Dialogs Library, Waterfall, Prompts (6 types), Activity Handlers</p>
                </div>
                <div class="feature-card">
                    <h5>ğŸ´ Chapters 11-13</h5>
                    <p>Rich Cards, Adaptive Cards, Proactive Messaging</p>
                </div>
                <div class="feature-card">
                    <h5>ğŸ”§ Chapters 14-17</h5>
                    <p>CLU/NLU, Skills, Testing (Emulator), Azure Deployment</p>
                </div>
                <div class="feature-card">
                    <h5>ğŸ” Chapter 18</h5>
                    <p>User Authentication, OAuth, Token Service, Sign-in Cards</p>
                </div>
                <div class="feature-card">
                    <h5>ğŸ’¬ Chapters 19-21</h5>
                    <p>Teams Bots, Suggested Actions, Bot Framework Composer</p>
                </div>
            </div>

            <div class="hinglish-note" style="margin-top: 1.5rem; font-size: 0.95rem; line-height: 1.6;">
                ğŸš€ <strong>Final Takeaway â€” MS Learn + Real Code Samples!</strong><br><br>
                
                <strong>21 Chapters + Python/C# Code from botbuilder-samples repo!</strong><br>
                âœ… Bot Basics â€” Activities, Turns, Structure + <strong>Echo Bot code</strong><br>
                âœ… Dialogs & Prompts â€” Multi-turn conversations + <strong>Waterfall Dialog code</strong><br>
                âœ… State Management â€” 3 state buckets + <strong>State Bot code</strong><br>
                âœ… Rich Messages â€” Cards, Adaptive Cards + <strong>Hero/Receipt Card code</strong><br>
                âœ… Channels â€” 12+ platforms supported<br>
                âœ… Authentication â€” OAuth, Token Service + <strong>Auth Bot code</strong><br>
                âœ… Teams Integration â€” Special handlers<br>
                âœ… Skills â€” Reusable bot capabilities + <strong>Root/Skill Bot code</strong><br>
                âœ… Middleware â€” Request/Response pipeline + <strong>Translation Middleware code</strong><br>
                âœ… Proactive Messaging + <strong>ConversationReference code</strong><br>
                âœ… Suggested Actions + <strong>Python code</strong><br>
                âœ… Testing & Deployment â€” Emulator, Azure<br>
                âœ… Composer â€” Visual authoring<br><br>
                
                <strong style="color: var(--accent-purple);">ğŸ Python code from: github.com/microsoft/botbuilder-samples</strong><br><br>
                
                <strong style="color: var(--accent-blue);">ğŸ¢ C# Enterprise code from: Azure Bot Service Intercom Codebase</strong><br>
                (CCIVR/Intercom â€” Production ABS Infrastructure including Channels, LUIS, Auth, PostBox, TokenMaker, Speech Services)<br><br>
                
                <strong style="color: var(--accent-orange);">âš ï¸ Important:</strong> Bot Framework SDK archived Dec 2025 â€” consider <strong>Microsoft 365 Agents SDK</strong> for new projects!<br><br>
                
                <em>"Ab tum Azure Bot Service ke concepts + real enterprise production code dono jaante ho! ğŸ‰"</em>
            </div>
        </div>
    </main>

    <!-- Prism.js for Syntax Highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                darkMode: true,
                background: '#0d1117',
                primaryColor: '#0078d4',
                primaryTextColor: '#fff',
                primaryBorderColor: '#30363d',
                lineColor: '#8b949e',
                secondaryColor: '#161b22',
                tertiaryColor: '#21262d'
            },
            flowchart: {
                curve: 'basis',
                padding: 20
            }
        });

        // Reading Progress
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('readingProgress').style.width = scrolled + '%';
        });

        // Search Functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = searchTerm ? 'none' : 'flex';
                }
            });
        });

        // Active Nav Item
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
            item.addEventListener('click', function() {
                navItems.forEach(i => i.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
